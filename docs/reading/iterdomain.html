

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Mathematical Theory of IterDomain &mdash; nvFuser 0.2.34 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/nvidia_font.css?v=e009355c" />
      <link rel="stylesheet" type="text/css" href="../_static/css/nvidia_footer.css?v=84031d34" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b85e2031"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multi-GPU Support in nvFuser" href="multigpu.html" />
    <link rel="prev" title="Divisibility of Split" href="divisibility-of-split.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="../index.html" class="icon icon-home">
            nvFuser
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-menu > p > span.caption-text {
      color: #76b900;
    }

    .wy-menu-vertical p {
      height: 32px;
      line-height: 32px;
      padding: 0 1.618em;
      margin: 12px 0 0;
      display: block;
      font-weight: 700;
      text-transform: uppercase;
      font-size: 85%;
      white-space: nowrap;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 1000px;
    }

    /* override table width restrictions */
    .wy-table-responsive table td, .wy-table-responsive table th {
        /* !important prevents the common CSS stylesheets from
          overriding this as on RTD they are loaded after this stylesheet */
        white-space: normal !important;
    }

    .wy-table-responsive {
        overflow: visible !important;
    }

  </style>
  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple)>dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }

  html.writer-html4 .rst-content dl:not(.docutils) .property, html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple) .property {
    text-transform: capitalize;
    display: inline-block;
    padding-right: 8px;
  }
  </style>

  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#nightly-nvfuser-pip-wheel">Nightly nvfuser pip wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#nvfuser-pip-wheel-against-pytorch-stable-release">Nvfuser pip wheel against pytorch stable release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#developer">Developer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#install-from-source">Install From Source:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/general.html">General</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#statement">Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#val">Val</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#expr">Expr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#iterdomain">IterDomain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#tensordomain">TensorDomain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#tensorview">TensorView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#fusionexecutorcache">FusionExecutorCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#kernelexecutor">KernelExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#fusion-definition">Fusion Definition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/ops.html">Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/ops.html#ops">Ops</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/multidevice.html">Multidevice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#communicator">Communicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#devicemesh">DeviceMesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#sharding">Sharding</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/enum.html">Enums</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#communicatorbackend-types">CommunicatorBackend Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#data-types">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#parallel-types">Parallel Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#scheduler-types">Scheduler Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/pod_class.html">Data classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/pod_class.html#launchparams">LaunchParams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pod_class.html#compileparams">CompileParams</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="divisibility-of-split.html">Divisibility of Split</a><ul>
<li class="toctree-l2"><a class="reference internal" href="divisibility-of-split.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="divisibility-of-split.html#predication">Predication</a></li>
<li class="toctree-l2"><a class="reference internal" href="divisibility-of-split.html#allocation-and-correctness-model">Allocation and correctness model</a></li>
<li class="toctree-l2"><a class="reference internal" href="divisibility-of-split.html#properties-of-split">Properties of split</a><ul>
<li class="toctree-l3"><a class="reference internal" href="divisibility-of-split.html#merge-then-split-vs-split-then-merge">Merge-then-split vs split-then-merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="divisibility-of-split.html#merging-discontiguous-iterdomains">Merging discontiguous IterDomains</a><ul>
<li class="toctree-l4"><a class="reference internal" href="divisibility-of-split.html#question">Question</a></li>
<li class="toctree-l4"><a class="reference internal" href="divisibility-of-split.html#answer">Answer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Mathematical Theory of IterDomain</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#iterdomain-transformations">1. IterDomain Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#properties-of-iterdomain-transformations">2. Properties of IterDomain Transformations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="multigpu.html">Multi-GPU Support in nvFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#user-api">User API</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#parallelisms">Parallelisms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#tensor-parallelism-tp">Tensor Parallelism (TP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#sharding-propagation">Sharding Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#communication-computation-decomposition">Communication-computation Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#sequence-parallelism-sp">Sequence Parallelism (SP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#id1">Sharding Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#id2">Communication-computation Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#overlap-communication-with-gemm-via-decomposition">Overlap Communication with GEMM via Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#distributed-data-parallelism-ddp">Distributed Data Parallelism (DDP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#fully-sharded-data-parallelism-fsdp">Fully Sharded Data Parallelism (FSDP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#pipeline-parallelism-pp">Pipeline Parallelism (PP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#context-parallelism-cp">Context Parallelism (CP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tma-modeling-in-depth.html">TMA Modeling In Depth</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#what-is-tma">What is TMA?</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#correctness-model">Correctness model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#the-unachievability-of-strong-correctness-for-indivisible-element-stride">The unachievability of strong correctness for indivisible element stride</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#the-lowering-strategy">The lowering strategy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/debug.html">Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-a-failing-nvfuser-script">Debug a failing nvFuser script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#nvfuser-dump">NVFUSER_DUMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#gdb">gdb</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-memory-corruption-using-asan">Debug memory corruption using <code class="docutils literal notranslate"><span class="pre">asan</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#if-built-with-clang">If built with clang</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-memory-leaks-or-excessive-memory-usage">Debug memory leaks or excessive memory usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-slow-kernels">Debug slow kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-slow-cpu-execution">Debug slow CPU execution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/visibility.html">Symbol Visibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/visibility.html#faq">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#should-i-mark-a-method-visible-or-the-whole-class">Should I mark a method visible or the whole class?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-an-undefined-reference-to-typeinfo-for-class-how-do-i-fix-this">I see an undefined reference to <code class="docutils literal notranslate"><span class="pre">typeinfo</span> <span class="pre">for</span> <span class="pre">&lt;class&gt;</span></code>. How do I fix this?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-an-undefined-reference-to-vtable-for-class-how-do-i-fix-this">I see an undefined reference to <code class="docutils literal notranslate"><span class="pre">vtable</span> <span class="pre">for</span> <span class="pre">&lt;class&gt;</span></code>. How do I fix this?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-that-foo-is-visible-but-i-do-not-think-it-needs-to-be">I see that <code class="docutils literal notranslate"><span class="pre">Foo</span></code> is visible but I do not think it needs to be.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#should-i-mark-my-new-method-or-class-as-nvf-api">Should I mark my new method or class as <code class="docutils literal notranslate"><span class="pre">NVF_API</span></code>?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/visibility.html#symbol-visibility-checking">Symbol Visibility Checking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/host_ir_jit.html">Host IR JIT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#jit-compilation-process">JIT Compilation Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#llvm-integration">1. LLVM Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#compilation-pipeline">2. Compilation Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#external-function-integration">3. External Function Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#ir-translation">3. IR Translation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#runtime-execution">Runtime Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#function-interface">1. Function Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#execution-flow">2. Execution Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#configuration-and-build-options">Configuration and Build Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#future-integration-plan">Future Integration plan</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html">LdMatrix and StMatrix Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#what-is-ldmatrix">What is LdMatrix?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#what-is-stmatrix">What is StMatrix?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#general-details">General Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#indices-shared-memory-tensor">Indices shared memory tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#indices-for-register-tensor">Indices for register tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#register-layout-for-one-8x8-matrix-with-16-bit-elements">Register layout for one 8x8 Matrix with 16-bit elements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#example-1-a-copy-kernel-using-tma-ldmatrix-and-stmatrix">Example 1: A copy kernel using TMA, LdMatrix, and StMatrix.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#how-to-compute-the-index-into-register-tensorview">How to compute the index into register TensorView?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#how-to-compute-the-index-into-shared-memory-tensorview">How to compute the index into shared memory TensorView?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-1-loop-domain-for-ldmatrix-and-stmatrix">Figure 1: Loop domain for LdMatrix and StMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-2-tma-shared-memory-allocation-domain">Figure 2: TMA shared memory allocation domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-3-map-from-ldmatrix-stmatrix-loop-domain-to-tma-shared-memory-allocation-domain">Figure 3: Map from LdMatrix / StMatrix loop domain to TMA shared memory allocation domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#derivation-of-figure-3">Derivation of Figure 3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#code-walkthrough">Code Walkthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#scheduleldstmatrix-function">scheduleLdStMatrix function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/tma.html">Introduction to TMA Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/tma.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tma.html#schedule">Schedule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-1-define-tma-domain">Step 1: define TMA domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-2-define-box">Step 2: define box</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#the-canonical-way-to-define-box">The canonical way to define box</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#define-box-by-mathematical-equivalence">Define box by mathematical equivalence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-3-define-tile">Step 3: define tile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-4-schedule-the-shared-memory-tensor">Step 4: schedule the shared memory tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#data-swizzle">Data swizzle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-5-schedule-the-consumer-tensor">Step 5: schedule the consumer tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#code-walk-through">Code walk-through</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-1-tma-load-inputs-and-vectorize-store-output-pointwise-kernel">Example 1: tma-load inputs and vectorize-store output pointwise kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-2-broadcast-kernel-with-discontiguous-input">Example 2: broadcast kernel with discontiguous input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-3-bank-conflict-free-transpose-of-32bit-data">Example 3: bank-conflict-free transpose of 32bit data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/tmem.html">Tensor Memory Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#review-of-inlining-and-parallelization">Review of inlining and parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#tensor-memory">Tensor memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#the-loop-domain-of-tmem-load-and-store">The loop domain of TMem load and store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#vectorization-of-tmem-load-and-store">Vectorization of TMem load and store</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nvFuser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">The Mathematical Theory of IterDomain</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reading/iterdomain.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!--
 * SPDX-FileCopyrightText: Copyright (c) 2023-present NVIDIA CORPORATION & AFFILIATES.
 * All rights reserved.
 * SPDX-License-Identifier: BSD-3-Clause
-->
<section class="tex2jax_ignore mathjax_ignore" id="the-mathematical-theory-of-iterdomain">
<h1>The Mathematical Theory of IterDomain<a class="headerlink" href="#the-mathematical-theory-of-iterdomain" title="Link to this heading"></a></h1>
<blockquote>
<div><p>[!NOTE]
We use <span class="math notranslate nohighlight">\(\div\)</span> for true division, and <span class="math notranslate nohighlight">\(/\)</span> for Euclidean division, and <span class="math notranslate nohighlight">\(\lceil/\rceil\)</span> for ceil division. For example, <span class="math notranslate nohighlight">\(5\div 2 = 2.5\)</span>, <span class="math notranslate nohighlight">\(5/2=2\)</span>, <span class="math notranslate nohighlight">\(5\lceil/\rceil 2 = 3\)</span>.</p>
</div></blockquote>
<section id="iterdomain-transformations">
<h2>1. IterDomain Transformations<a class="headerlink" href="#iterdomain-transformations" title="Link to this heading"></a></h2>
<p><strong>Definition 1.1 (IterDomain Transformation)</strong>:
An <em>IterDomain transformation</em> of rank <span class="math notranslate nohighlight">\((m, n)\)</span> is a pair of two mappings <span class="math notranslate nohighlight">\(\langle\mathbb{Z}^{m}\to\mathbb{Z}^{n}, \mathbb{Z}^{m}\to\mathbb{Z}^{n}\rangle\)</span>,
called extent mapping and index mapping.
We use notation <span class="math notranslate nohighlight">\(t\langle E, I\rangle\)</span> to denote an IterDomain transformation whose name is <span class="math notranslate nohighlight">\(t\)</span>, extent mapping is <span class="math notranslate nohighlight">\(E\)</span> and index mapping is <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p><strong>Definition 1.1.1 (Inner Split)</strong>:
Given <span class="math notranslate nohighlight">\(d\in\mathbb{Z}^{+}\)</span>, an <em>inner split</em> with factor <span class="math notranslate nohighlight">\(d\)</span> is an IterDomain transformation of rank <span class="math notranslate nohighlight">\((1, 2)\)</span>,
where the extent map is <span class="math notranslate nohighlight">\(i \to (i \lceil/\rceil d, d)\)</span>,
and the index map is <span class="math notranslate nohighlight">\(i \to (i/d, i \mathbin{\\%} d)\)</span>.
We use notation <span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(d)\)</span> to denote inner split.</p>
<blockquote>
<div><p>[!CAUTION]
TODO: outer split, merge, resize, swizzle, reorder</p>
</div></blockquote>
<p><strong>Definition 1.2 (Equivalence of IterDomain Transformation)</strong>:
Two IterDomain transformations of rank <span class="math notranslate nohighlight">\((m, n)\)</span> are equivalent if both the extent mapping and index mapping are equivalent.</p>
<p>We use the notation <span class="math notranslate nohighlight">\(t_1 = t_2\)</span> to denote their equivalence.</p>
<p><strong>Theorem 1.1:</strong>
For arbitrary three IterDomain transformations <span class="math notranslate nohighlight">\(t_1\)</span>, <span class="math notranslate nohighlight">\(t_2\)</span> and <span class="math notranslate nohighlight">\(t_3\)</span> of rank <span class="math notranslate nohighlight">\((m, n)\)</span>, we have:</p>
<ul class="simple">
<li><p>Reflexivity: <span class="math notranslate nohighlight">\(t_1 = t_1\)</span></p></li>
<li><p>Symmetry: if <span class="math notranslate nohighlight">\(t_1 = t_2\)</span>, then <span class="math notranslate nohighlight">\(t_2 = t_1\)</span>.</p></li>
<li><p>Transitivity: if <span class="math notranslate nohighlight">\(t_1 = t_2\)</span> and <span class="math notranslate nohighlight">\(t_2 = t_3\)</span>, then <span class="math notranslate nohighlight">\(t_1 = t_3\)</span>.</p></li>
</ul>
<p>That is, the equivalence of IterDomain transformations is an equivalence relation mathematically.</p>
<p>This theorem can be easily proved by applying the reflexivity, symmetry, and transitivity to both the extent mapping and index mapping.</p>
<p><strong>Definition 1.3: (Embedding of IterDomain Transformation)</strong>:
Let <span class="math notranslate nohighlight">\(t_1\langle E, I\rangle\)</span> be an IterDomain transformation of rank <span class="math notranslate nohighlight">\((m, n)\)</span>, and <span class="math notranslate nohighlight">\(l, r \in \mathbb{N}\)</span>,
an IterDomain transformation <span class="math notranslate nohighlight">\(t_2\)</span> of rank <span class="math notranslate nohighlight">\((l + m + r, l + n + r)\)</span> is an embedding of <span class="math notranslate nohighlight">\(t_1\)</span> on dimensions <span class="math notranslate nohighlight">\(l\)</span> to <span class="math notranslate nohighlight">\(l + m - 1\)</span>
if the extent mapping of <span class="math notranslate nohighlight">\(t_2\)</span> is <span class="math notranslate nohighlight">\((x_0, \ldots, x_{l + m + r - 1}) \to \left(x_0, \ldots, x_{l - 1}, E(x_l, \ldots, x_{l + m - 1}), x_{l + m}, \ldots, x_{l + m + r - 1}\right)\)</span>,
and the index mapping of <span class="math notranslate nohighlight">\(t_2\)</span> is <span class="math notranslate nohighlight">\((x_0, \ldots, x_{l + m + r - 1}) \to \left(x_0, \ldots, x_{l - 1}, I(x_l, \ldots, x_{l + m - 1}), x_{l + m}, \ldots, x_{l + m + r - 1}\right)\)</span>.</p>
<p>We use the notation <span class="math notranslate nohighlight">\(t_1[l, \ldots, l + m - 1]\)</span> to the embedding of <span class="math notranslate nohighlight">\(t_1\)</span> on dimensions <span class="math notranslate nohighlight">\(l\)</span> to <span class="math notranslate nohighlight">\(l + m - 1\)</span>.</p>
<p><strong>Definition 1.4: (Composition of IterDomain Transformations)</strong>:
Let <span class="math notranslate nohighlight">\(t_1\langle E_1, I_1\rangle\)</span> be an IterDomain transformation of rank <span class="math notranslate nohighlight">\((m, n)\)</span>,
and <span class="math notranslate nohighlight">\(t_2\langle E_2, I_2\rangle\)</span> be an IterDomain transformation of rank <span class="math notranslate nohighlight">\((n, l)\)</span>,
The composition of <span class="math notranslate nohighlight">\(t_1\)</span> with <span class="math notranslate nohighlight">\(t_2\)</span>, denoted as <span class="math notranslate nohighlight">\(t_2 \circ t_1\)</span>, is the IterDomain transformation <span class="math notranslate nohighlight">\(\langle E_2 \circ E_1, I_2 \circ I_1\rangle\)</span>. The rank of <span class="math notranslate nohighlight">\(t_2 \circ t_1\)</span> is <span class="math notranslate nohighlight">\((m, l)\)</span>.</p>
</section>
<section id="properties-of-iterdomain-transformations">
<h2>2. Properties of IterDomain Transformations<a class="headerlink" href="#properties-of-iterdomain-transformations" title="Link to this heading"></a></h2>
<p><strong>Theorem 2.1 (Equivalence of Split-Split)</strong>: Let <span class="math notranslate nohighlight">\(m, n \in \mathbb{Z}\)</span>, we have:
$<span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(m)[0] \circ \mathrm{InnerSplit}(n) = \mathrm{InnerSplit}(n)[1] \circ \mathrm{InnerSplit}(m\cdot n)\)</span>$</p>
<p>Visually, we have:</p>
<p><img alt="Equivalence of Split-Split" src="../_images/split-split.svg" /></p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p><strong>The extent mapping:</strong></p>
<p>The extent mapping of <span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(m)[0] \circ \mathrm{InnerSplit}(n)\)</span> is <span class="math notranslate nohighlight">\(i \to (i \lceil/\rceil n \lceil/\rceil m, m, n)\)</span>.</p>
<p>The extent mapping of <span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(n)[1] \circ \mathrm{InnerSplit}(m\cdot n)\)</span> is <span class="math notranslate nohighlight">\(i \to (i \lceil/\rceil (m\cdot n), m, n)\)</span>.</p>
<p>According to Theorem 5.11 in <span class="xref myst">Integer Division</span>: <span class="math notranslate nohighlight">\(i \lceil/\rceil n \lceil/\rceil m = i \lceil/\rceil (m\cdot n)\)</span>.</p>
<p><strong>The index mapping:</strong></p>
<p>The index mapping of <span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(m)[0] \circ \mathrm{InnerSplit}(n)\)</span> is <span class="math notranslate nohighlight">\(i \to (i / n / m, i / n \mathbin{\\%} m, i \mathbin{\\%} n)\)</span>.</p>
<p>The index mapping of <span class="math notranslate nohighlight">\(\mathrm{InnerSplit}(n)[1] \circ \mathrm{InnerSplit}(m\cdot n)\)</span> is <span class="math notranslate nohighlight">\(i \to (i / (m\cdot n), i \mathbin{\\%} (m\cdot n) / n, i \mathbin{\\%} (m\cdot n) \mathbin{\\%} n)\)</span>.</p>
<p>According to Theorem 2.11 in <span class="xref myst">Integer Division</span>: <span class="math notranslate nohighlight">\(i / n / m = i / (m\cdot n)\)</span>.</p>
<p>According to Theorem 2.12 in <span class="xref myst">Integer Division</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}i \mathbin{\\%} (m\cdot n) = i \mathbin{\\%} n + ((i / n) \mathbin{\\%} m) \times n\end{split}\]</div>
<p>According to Theorem 2.15.1 in <span class="xref myst">Integer Division</span>:
$<span class="math notranslate nohighlight">\(i \mathbin{\\%} (m\cdot n) / n = (i / n) \mathbin{\\%} m\)</span>$</p>
<p>According to Theorem 2.7.1 in <span class="xref myst">Integer Division</span>:
$<span class="math notranslate nohighlight">\(i \mathbin{\\%} (m\cdot n) \mathbin{\\%} n = i \mathbin{\\%} n\)</span>$</p>
<p><span class="math notranslate nohighlight">\(\square\)</span></p>
</details>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="divisibility-of-split.html" class="btn btn-neutral float-left" title="Divisibility of Split" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="multigpu.html" class="btn btn-neutral float-right" title="Multi-GPU Support in nvFuser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
<img src="../_static/NVIDIA-LogoBlack.svg"/>
<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>

    <p>&#169; Copyright 2023-2025, NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved..</p>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
        Version: 0.2.34
        
    </span>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>