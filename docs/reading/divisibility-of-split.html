

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Divisibility of Split &mdash; nvFuser 0.2.34 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/nvidia_font.css?v=e009355c" />
      <link rel="stylesheet" type="text/css" href="../_static/css/nvidia_footer.css?v=84031d34" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b85e2031"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Mathematical Theory of IterDomain" href="iterdomain.html" />
    <link rel="prev" title="Data classes" href="../api/pod_class.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="../index.html" class="icon icon-home">
            nvFuser
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-menu > p > span.caption-text {
      color: #76b900;
    }

    .wy-menu-vertical p {
      height: 32px;
      line-height: 32px;
      padding: 0 1.618em;
      margin: 12px 0 0;
      display: block;
      font-weight: 700;
      text-transform: uppercase;
      font-size: 85%;
      white-space: nowrap;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 1000px;
    }

    /* override table width restrictions */
    .wy-table-responsive table td, .wy-table-responsive table th {
        /* !important prevents the common CSS stylesheets from
          overriding this as on RTD they are loaded after this stylesheet */
        white-space: normal !important;
    }

    .wy-table-responsive {
        overflow: visible !important;
    }

  </style>
  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple)>dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }

  html.writer-html4 .rst-content dl:not(.docutils) .property, html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple) .property {
    text-transform: capitalize;
    display: inline-block;
    padding-right: 8px;
  }
  </style>

  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#nightly-nvfuser-pip-wheel">Nightly nvfuser pip wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#nvfuser-pip-wheel-against-pytorch-stable-release">Nvfuser pip wheel against pytorch stable release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#developer">Developer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#install-from-source">Install From Source:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/general.html">General</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#statement">Statement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.Statement"><code class="docutils literal notranslate"><span class="pre">Statement</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#val">Val</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.Val"><code class="docutils literal notranslate"><span class="pre">Val</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Val.definition"><code class="docutils literal notranslate"><span class="pre">Val.definition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Val.is_symbolic"><code class="docutils literal notranslate"><span class="pre">Val.is_symbolic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Val.is_tensor"><code class="docutils literal notranslate"><span class="pre">Val.is_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Val.uses"><code class="docutils literal notranslate"><span class="pre">Val.uses()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#expr">Expr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.Expr"><code class="docutils literal notranslate"><span class="pre">Expr</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Expr.input"><code class="docutils literal notranslate"><span class="pre">Expr.input()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.Expr.output"><code class="docutils literal notranslate"><span class="pre">Expr.output()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#iterdomain">IterDomain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.IterDomain"><code class="docutils literal notranslate"><span class="pre">IterDomain</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.IterDomain.extent"><code class="docutils literal notranslate"><span class="pre">IterDomain.extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.IterDomain.parallelize"><code class="docutils literal notranslate"><span class="pre">IterDomain.parallelize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#tensordomain">TensorDomain</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorDomain"><code class="docutils literal notranslate"><span class="pre">TensorDomain</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#tensorview">TensorView</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView"><code class="docutils literal notranslate"><span class="pre">TensorView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.axis"><code class="docutils literal notranslate"><span class="pre">TensorView.axis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.cache_after"><code class="docutils literal notranslate"><span class="pre">TensorView.cache_after()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.cache_before"><code class="docutils literal notranslate"><span class="pre">TensorView.cache_before()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.domain"><code class="docutils literal notranslate"><span class="pre">TensorView.domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.get_logical_domain"><code class="docutils literal notranslate"><span class="pre">TensorView.get_logical_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.get_loop_domain"><code class="docutils literal notranslate"><span class="pre">TensorView.get_loop_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.get_root_domain"><code class="docutils literal notranslate"><span class="pre">TensorView.get_root_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.has_root"><code class="docutils literal notranslate"><span class="pre">TensorView.has_root()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.merge"><code class="docutils literal notranslate"><span class="pre">TensorView.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.ndim"><code class="docutils literal notranslate"><span class="pre">TensorView.ndim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.reorder"><code class="docutils literal notranslate"><span class="pre">TensorView.reorder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.rfactor"><code class="docutils literal notranslate"><span class="pre">TensorView.rfactor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.set_allocation_domain"><code class="docutils literal notranslate"><span class="pre">TensorView.set_allocation_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.set_device_mesh"><code class="docutils literal notranslate"><span class="pre">TensorView.set_device_mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.set_memory_type"><code class="docutils literal notranslate"><span class="pre">TensorView.set_memory_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.shape"><code class="docutils literal notranslate"><span class="pre">TensorView.shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.size"><code class="docutils literal notranslate"><span class="pre">TensorView.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.TensorView.split"><code class="docutils literal notranslate"><span class="pre">TensorView.split()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#fusionexecutorcache">FusionExecutorCache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.execute"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.fusion"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.fusion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.get_cuda_kernel"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.get_cuda_kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.get_most_recent_scheduled_ir"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.get_most_recent_scheduled_ir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.get_output_shardings"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.get_output_shardings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.get_scheduled_ir"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.get_scheduled_ir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionExecutorCache.is_compiled"><code class="docutils literal notranslate"><span class="pre">FusionExecutorCache.is_compiled()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#kernelexecutor">KernelExecutor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.KernelExecutor"><code class="docutils literal notranslate"><span class="pre">KernelExecutor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.KernelExecutor.compile"><code class="docutils literal notranslate"><span class="pre">KernelExecutor.compile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.KernelExecutor.is_compiled"><code class="docutils literal notranslate"><span class="pre">KernelExecutor.is_compiled()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.KernelExecutor.run"><code class="docutils literal notranslate"><span class="pre">KernelExecutor.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/general.html#fusion-definition">Fusion Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition"><code class="docutils literal notranslate"><span class="pre">FusionDefinition</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.add_output"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.add_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.define_scalar"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.define_scalar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.define_tensor"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.define_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.define_vector"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.define_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.execute"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.from_pytorch"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.from_pytorch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.fusion"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.fusion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.last_repro_script"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.last_repro_script()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.manual_execute"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.manual_execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.manual_validate"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.manual_validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.repro_script_for"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.repro_script_for()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.validate"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/general.html#nvfuser_direct.FusionDefinition.validate_definition"><code class="docutils literal notranslate"><span class="pre">FusionDefinition.validate_definition()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/ops.html">Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/ops.html#module-nvfuser_direct.ops">Ops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.abs"><code class="docutils literal notranslate"><span class="pre">abs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.acos"><code class="docutils literal notranslate"><span class="pre">acos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.acosh"><code class="docutils literal notranslate"><span class="pre">acosh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.add"><code class="docutils literal notranslate"><span class="pre">add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.addcmul"><code class="docutils literal notranslate"><span class="pre">addcmul()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.argsort"><code class="docutils literal notranslate"><span class="pre">argsort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.asin"><code class="docutils literal notranslate"><span class="pre">asin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.asinh"><code class="docutils literal notranslate"><span class="pre">asinh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.atan"><code class="docutils literal notranslate"><span class="pre">atan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.atan2"><code class="docutils literal notranslate"><span class="pre">atan2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.atanh"><code class="docutils literal notranslate"><span class="pre">atanh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_and"><code class="docutils literal notranslate"><span class="pre">bitwise_and()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_left_shift"><code class="docutils literal notranslate"><span class="pre">bitwise_left_shift()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_not"><code class="docutils literal notranslate"><span class="pre">bitwise_not()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_or"><code class="docutils literal notranslate"><span class="pre">bitwise_or()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_right_shift"><code class="docutils literal notranslate"><span class="pre">bitwise_right_shift()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.bitwise_xor"><code class="docutils literal notranslate"><span class="pre">bitwise_xor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.broadcast"><code class="docutils literal notranslate"><span class="pre">broadcast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.broadcast_in_dim"><code class="docutils literal notranslate"><span class="pre">broadcast_in_dim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cast"><code class="docutils literal notranslate"><span class="pre">cast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.ceil"><code class="docutils literal notranslate"><span class="pre">ceil()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.clamp"><code class="docutils literal notranslate"><span class="pre">clamp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.complex"><code class="docutils literal notranslate"><span class="pre">complex()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cos"><code class="docutils literal notranslate"><span class="pre">cos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cosh"><code class="docutils literal notranslate"><span class="pre">cosh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cummax"><code class="docutils literal notranslate"><span class="pre">cummax()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cummin"><code class="docutils literal notranslate"><span class="pre">cummin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cumprod"><code class="docutils literal notranslate"><span class="pre">cumprod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cumsum"><code class="docutils literal notranslate"><span class="pre">cumsum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.cutlass_nvfp4_grouped_mm"><code class="docutils literal notranslate"><span class="pre">cutlass_nvfp4_grouped_mm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.div"><code class="docutils literal notranslate"><span class="pre">div()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.embedding_fwd"><code class="docutils literal notranslate"><span class="pre">embedding_fwd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.eq"><code class="docutils literal notranslate"><span class="pre">eq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.erf"><code class="docutils literal notranslate"><span class="pre">erf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.erfc"><code class="docutils literal notranslate"><span class="pre">erfc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.erfcinv"><code class="docutils literal notranslate"><span class="pre">erfcinv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.erfinv"><code class="docutils literal notranslate"><span class="pre">erfinv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.exp"><code class="docutils literal notranslate"><span class="pre">exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.exp2"><code class="docutils literal notranslate"><span class="pre">exp2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.expand"><code class="docutils literal notranslate"><span class="pre">expand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.expm1"><code class="docutils literal notranslate"><span class="pre">expm1()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.floor"><code class="docutils literal notranslate"><span class="pre">floor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.fmod"><code class="docutils literal notranslate"><span class="pre">fmod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.frac"><code class="docutils literal notranslate"><span class="pre">frac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.full"><code class="docutils literal notranslate"><span class="pre">full()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.gather"><code class="docutils literal notranslate"><span class="pre">gather()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.ge"><code class="docutils literal notranslate"><span class="pre">ge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.grouped_mm"><code class="docutils literal notranslate"><span class="pre">grouped_mm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.gt"><code class="docutils literal notranslate"><span class="pre">gt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.imag"><code class="docutils literal notranslate"><span class="pre">imag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.index_select"><code class="docutils literal notranslate"><span class="pre">index_select()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.iota"><code class="docutils literal notranslate"><span class="pre">iota()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isfinite"><code class="docutils literal notranslate"><span class="pre">isfinite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isinf"><code class="docutils literal notranslate"><span class="pre">isinf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isnan"><code class="docutils literal notranslate"><span class="pre">isnan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isneginf"><code class="docutils literal notranslate"><span class="pre">isneginf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isposinf"><code class="docutils literal notranslate"><span class="pre">isposinf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.isreal"><code class="docutils literal notranslate"><span class="pre">isreal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.le"><code class="docutils literal notranslate"><span class="pre">le()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.lerp"><code class="docutils literal notranslate"><span class="pre">lerp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.lgamma"><code class="docutils literal notranslate"><span class="pre">lgamma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.linear"><code class="docutils literal notranslate"><span class="pre">linear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.log10"><code class="docutils literal notranslate"><span class="pre">log10()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.log1p"><code class="docutils literal notranslate"><span class="pre">log1p()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.log2"><code class="docutils literal notranslate"><span class="pre">log2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.logical_and"><code class="docutils literal notranslate"><span class="pre">logical_and()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.logical_not"><code class="docutils literal notranslate"><span class="pre">logical_not()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.logical_or"><code class="docutils literal notranslate"><span class="pre">logical_or()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.logical_right_shift"><code class="docutils literal notranslate"><span class="pre">logical_right_shift()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.lt"><code class="docutils literal notranslate"><span class="pre">lt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.matmul"><code class="docutils literal notranslate"><span class="pre">matmul()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.max"><code class="docutils literal notranslate"><span class="pre">max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.maximum"><code class="docutils literal notranslate"><span class="pre">maximum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.min"><code class="docutils literal notranslate"><span class="pre">min()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.minimum"><code class="docutils literal notranslate"><span class="pre">minimum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.mod"><code class="docutils literal notranslate"><span class="pre">mod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.mul"><code class="docutils literal notranslate"><span class="pre">mul()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.ne"><code class="docutils literal notranslate"><span class="pre">ne()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.neg"><code class="docutils literal notranslate"><span class="pre">neg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.nextafter"><code class="docutils literal notranslate"><span class="pre">nextafter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.normal"><code class="docutils literal notranslate"><span class="pre">normal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.pad"><code class="docutils literal notranslate"><span class="pre">pad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.permute"><code class="docutils literal notranslate"><span class="pre">permute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.pow"><code class="docutils literal notranslate"><span class="pre">pow()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.prod"><code class="docutils literal notranslate"><span class="pre">prod()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.rand_like"><code class="docutils literal notranslate"><span class="pre">rand_like()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.randn_like"><code class="docutils literal notranslate"><span class="pre">randn_like()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.real"><code class="docutils literal notranslate"><span class="pre">real()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.reciprocal"><code class="docutils literal notranslate"><span class="pre">reciprocal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.relu"><code class="docutils literal notranslate"><span class="pre">relu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.remainder"><code class="docutils literal notranslate"><span class="pre">remainder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.reshape"><code class="docutils literal notranslate"><span class="pre">reshape()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.round"><code class="docutils literal notranslate"><span class="pre">round()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.rsqrt"><code class="docutils literal notranslate"><span class="pre">rsqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.scaled_mm"><code class="docutils literal notranslate"><span class="pre">scaled_mm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.scatter"><code class="docutils literal notranslate"><span class="pre">scatter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sdpfa_bwd"><code class="docutils literal notranslate"><span class="pre">sdpfa_bwd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sdpfa_fwd"><code class="docutils literal notranslate"><span class="pre">sdpfa_fwd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.segment_set"><code class="docutils literal notranslate"><span class="pre">segment_set()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.select"><code class="docutils literal notranslate"><span class="pre">select()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.set"><code class="docutils literal notranslate"><span class="pre">set()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.shape"><code class="docutils literal notranslate"><span class="pre">shape()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sign"><code class="docutils literal notranslate"><span class="pre">sign()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.signbit"><code class="docutils literal notranslate"><span class="pre">signbit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.silu"><code class="docutils literal notranslate"><span class="pre">silu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sin"><code class="docutils literal notranslate"><span class="pre">sin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sinh"><code class="docutils literal notranslate"><span class="pre">sinh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.size"><code class="docutils literal notranslate"><span class="pre">size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.slice"><code class="docutils literal notranslate"><span class="pre">slice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sqrt"><code class="docutils literal notranslate"><span class="pre">sqrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.squeeze"><code class="docutils literal notranslate"><span class="pre">squeeze()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.stride_order"><code class="docutils literal notranslate"><span class="pre">stride_order()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sub"><code class="docutils literal notranslate"><span class="pre">sub()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.sum"><code class="docutils literal notranslate"><span class="pre">sum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.take_along_axis"><code class="docutils literal notranslate"><span class="pre">take_along_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.tan"><code class="docutils literal notranslate"><span class="pre">tan()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.tanh"><code class="docutils literal notranslate"><span class="pre">tanh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.threshold"><code class="docutils literal notranslate"><span class="pre">threshold()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.topk"><code class="docutils literal notranslate"><span class="pre">topk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.triu"><code class="docutils literal notranslate"><span class="pre">triu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.truediv"><code class="docutils literal notranslate"><span class="pre">truediv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.trunc"><code class="docutils literal notranslate"><span class="pre">trunc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.uniform"><code class="docutils literal notranslate"><span class="pre">uniform()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.var"><code class="docutils literal notranslate"><span class="pre">var()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.var_mean"><code class="docutils literal notranslate"><span class="pre">var_mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.welford"><code class="docutils literal notranslate"><span class="pre">welford()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/ops.html#nvfuser_direct.ops.where"><code class="docutils literal notranslate"><span class="pre">where()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/multidevice.html">Multidevice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#communicator">Communicator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator"><code class="docutils literal notranslate"><span class="pre">Communicator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.barrier"><code class="docutils literal notranslate"><span class="pre">Communicator.barrier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.instance"><code class="docutils literal notranslate"><span class="pre">Communicator.instance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.local_rank"><code class="docutils literal notranslate"><span class="pre">Communicator.local_rank()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.local_size"><code class="docutils literal notranslate"><span class="pre">Communicator.local_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.rank"><code class="docutils literal notranslate"><span class="pre">Communicator.rank()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Communicator.size"><code class="docutils literal notranslate"><span class="pre">Communicator.size()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#devicemesh">DeviceMesh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.DeviceMesh"><code class="docutils literal notranslate"><span class="pre">DeviceMesh</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.DeviceMesh.shape"><code class="docutils literal notranslate"><span class="pre">DeviceMesh.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.DeviceMesh.shard_tensor"><code class="docutils literal notranslate"><span class="pre">DeviceMesh.shard_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.DeviceMesh.size"><code class="docutils literal notranslate"><span class="pre">DeviceMesh.size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/multidevice.html#sharding">Sharding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Sharding"><code class="docutils literal notranslate"><span class="pre">Sharding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Sharding.axis_sharded_on"><code class="docutils literal notranslate"><span class="pre">Sharding.axis_sharded_on()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/multidevice.html#nvfuser_direct.multidevice.Sharding.mesh"><code class="docutils literal notranslate"><span class="pre">Sharding.mesh</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/enum.html">Enums</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#communicatorbackend-types">CommunicatorBackend Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/enum.html#nvfuser_direct.CommunicatorBackend"><code class="docutils literal notranslate"><span class="pre">CommunicatorBackend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/enum.html#nvfuser_direct.CommunicatorBackend.name"><code class="docutils literal notranslate"><span class="pre">CommunicatorBackend.name</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#data-types">Data Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/enum.html#nvfuser_direct.DataType"><code class="docutils literal notranslate"><span class="pre">DataType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/enum.html#nvfuser_direct.DataType.name"><code class="docutils literal notranslate"><span class="pre">DataType.name</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#parallel-types">Parallel Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/enum.html#nvfuser_direct.ParallelType"><code class="docutils literal notranslate"><span class="pre">ParallelType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/enum.html#nvfuser_direct.ParallelType.name"><code class="docutils literal notranslate"><span class="pre">ParallelType.name</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/enum.html#scheduler-types">Scheduler Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/enum.html#nvfuser_direct.SchedulerType"><code class="docutils literal notranslate"><span class="pre">SchedulerType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/enum.html#nvfuser_direct.SchedulerType.name"><code class="docutils literal notranslate"><span class="pre">SchedulerType.name</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/pod_class.html">Data classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/pod_class.html#launchparams">LaunchParams</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams"><code class="docutils literal notranslate"><span class="pre">LaunchParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.bdimx"><code class="docutils literal notranslate"><span class="pre">LaunchParams.bdimx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.bdimy"><code class="docutils literal notranslate"><span class="pre">LaunchParams.bdimy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.bdimz"><code class="docutils literal notranslate"><span class="pre">LaunchParams.bdimz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.gdimx"><code class="docutils literal notranslate"><span class="pre">LaunchParams.gdimx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.gdimy"><code class="docutils literal notranslate"><span class="pre">LaunchParams.gdimy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.LaunchParams.gdimz"><code class="docutils literal notranslate"><span class="pre">LaunchParams.gdimz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/pod_class.html#compileparams">CompileParams</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams"><code class="docutils literal notranslate"><span class="pre">CompileParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.device"><code class="docutils literal notranslate"><span class="pre">CompileParams.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.enable_magic_zero"><code class="docutils literal notranslate"><span class="pre">CompileParams.enable_magic_zero</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.enable_ptxas_verbose"><code class="docutils literal notranslate"><span class="pre">CompileParams.enable_ptxas_verbose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.include_paths"><code class="docutils literal notranslate"><span class="pre">CompileParams.include_paths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.index_type"><code class="docutils literal notranslate"><span class="pre">CompileParams.index_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/pod_class.html#nvfuser_direct.CompileParams.maxrregcount"><code class="docutils literal notranslate"><span class="pre">CompileParams.maxrregcount</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Divisibility of Split</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predication">Predication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#allocation-and-correctness-model">Allocation and correctness model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#properties-of-split">Properties of split</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#merge-then-split-vs-split-then-merge">Merge-then-split vs split-then-merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merging-discontiguous-iterdomains">Merging discontiguous IterDomains</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#question">Question</a></li>
<li class="toctree-l4"><a class="reference internal" href="#answer">Answer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iterdomain.html">The Mathematical Theory of IterDomain</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iterdomain.html#iterdomain-transformations">1. IterDomain Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="iterdomain.html#properties-of-iterdomain-transformations">2. Properties of IterDomain Transformations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="multigpu.html">Multi-GPU Support in nvFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#user-api">User API</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu.html#parallelisms">Parallelisms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#tensor-parallelism-tp">Tensor Parallelism (TP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#sharding-propagation">Sharding Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#communication-computation-decomposition">Communication-computation Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#sequence-parallelism-sp">Sequence Parallelism (SP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#id1">Sharding Propagation</a></li>
<li class="toctree-l4"><a class="reference internal" href="multigpu.html#id2">Communication-computation Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#overlap-communication-with-gemm-via-decomposition">Overlap Communication with GEMM via Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#distributed-data-parallelism-ddp">Distributed Data Parallelism (DDP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#fully-sharded-data-parallelism-fsdp">Fully Sharded Data Parallelism (FSDP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#pipeline-parallelism-pp">Pipeline Parallelism (PP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="multigpu.html#context-parallelism-cp">Context Parallelism (CP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tma-modeling-in-depth.html">TMA Modeling In Depth</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#what-is-tma">What is TMA?</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#correctness-model">Correctness model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#the-unachievability-of-strong-correctness-for-indivisible-element-stride">The unachievability of strong correctness for indivisible element stride</a></li>
<li class="toctree-l2"><a class="reference internal" href="tma-modeling-in-depth.html#the-lowering-strategy">The lowering strategy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/debug.html">Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-a-failing-nvfuser-script">Debug a failing nvFuser script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#nvfuser-dump">NVFUSER_DUMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#gdb">gdb</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-memory-corruption-using-asan">Debug memory corruption using <code class="docutils literal notranslate"><span class="pre">asan</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/debug.html#if-built-with-clang">If built with clang</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-memory-leaks-or-excessive-memory-usage">Debug memory leaks or excessive memory usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-slow-kernels">Debug slow kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/debug.html#debug-slow-cpu-execution">Debug slow CPU execution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/visibility.html">Symbol Visibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/visibility.html#faq">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#should-i-mark-a-method-visible-or-the-whole-class">Should I mark a method visible or the whole class?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-an-undefined-reference-to-typeinfo-for-class-how-do-i-fix-this">I see an undefined reference to <code class="docutils literal notranslate"><span class="pre">typeinfo</span> <span class="pre">for</span> <span class="pre">&lt;class&gt;</span></code>. How do I fix this?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-an-undefined-reference-to-vtable-for-class-how-do-i-fix-this">I see an undefined reference to <code class="docutils literal notranslate"><span class="pre">vtable</span> <span class="pre">for</span> <span class="pre">&lt;class&gt;</span></code>. How do I fix this?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#i-see-that-foo-is-visible-but-i-do-not-think-it-needs-to-be">I see that <code class="docutils literal notranslate"><span class="pre">Foo</span></code> is visible but I do not think it needs to be.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/visibility.html#should-i-mark-my-new-method-or-class-as-nvf-api">Should I mark my new method or class as <code class="docutils literal notranslate"><span class="pre">NVF_API</span></code>?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/visibility.html#symbol-visibility-checking">Symbol Visibility Checking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/host_ir_jit.html">Host IR JIT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#jit-compilation-process">JIT Compilation Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#llvm-integration">1. LLVM Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#compilation-pipeline">2. Compilation Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#external-function-integration">3. External Function Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#ir-translation">3. IR Translation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#runtime-execution">Runtime Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#function-interface">1. Function Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/host_ir_jit.html#execution-flow">2. Execution Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#configuration-and-build-options">Configuration and Build Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/host_ir_jit.html#future-integration-plan">Future Integration plan</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html">LdMatrix and StMatrix Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#what-is-ldmatrix">What is LdMatrix?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#what-is-stmatrix">What is StMatrix?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#general-details">General Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#indices-shared-memory-tensor">Indices shared memory tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#indices-for-register-tensor">Indices for register tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#register-layout-for-one-8x8-matrix-with-16-bit-elements">Register layout for one 8x8 Matrix with 16-bit elements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#example-1-a-copy-kernel-using-tma-ldmatrix-and-stmatrix">Example 1: A copy kernel using TMA, LdMatrix, and StMatrix.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#how-to-compute-the-index-into-register-tensorview">How to compute the index into register TensorView?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#how-to-compute-the-index-into-shared-memory-tensorview">How to compute the index into shared memory TensorView?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-1-loop-domain-for-ldmatrix-and-stmatrix">Figure 1: Loop domain for LdMatrix and StMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-2-tma-shared-memory-allocation-domain">Figure 2: TMA shared memory allocation domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#figure-3-map-from-ldmatrix-stmatrix-loop-domain-to-tma-shared-memory-allocation-domain">Figure 3: Map from LdMatrix / StMatrix loop domain to TMA shared memory allocation domain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#derivation-of-figure-3">Derivation of Figure 3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#code-walkthrough">Code Walkthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/ldmatrix_stmatrix.html#scheduleldstmatrix-function">scheduleLdStMatrix function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/tma.html">Introduction to TMA Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/tma.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tma.html#schedule">Schedule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-1-define-tma-domain">Step 1: define TMA domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-2-define-box">Step 2: define box</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#the-canonical-way-to-define-box">The canonical way to define box</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#define-box-by-mathematical-equivalence">Define box by mathematical equivalence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-3-define-tile">Step 3: define tile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-4-schedule-the-shared-memory-tensor">Step 4: schedule the shared memory tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#data-swizzle">Data swizzle</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#step-5-schedule-the-consumer-tensor">Step 5: schedule the consumer tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#code-walk-through">Code walk-through</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/tma.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-1-tma-load-inputs-and-vectorize-store-output-pointwise-kernel">Example 1: tma-load inputs and vectorize-store output pointwise kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-2-broadcast-kernel-with-discontiguous-input">Example 2: broadcast kernel with discontiguous input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev/tma.html#example-3-bank-conflict-free-transpose-of-32bit-data">Example 3: bank-conflict-free transpose of 32bit data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev/tmem.html">Tensor Memory Support in NVFuser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#review-of-inlining-and-parallelization">Review of inlining and parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#tensor-memory">Tensor memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#the-loop-domain-of-tmem-load-and-store">The loop domain of TMem load and store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/tmem.html#vectorization-of-tmem-load-and-store">Vectorization of TMem load and store</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nvFuser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Divisibility of Split</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reading/divisibility-of-split.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!--
 * SPDX-FileCopyrightText: Copyright (c) 2023-present NVIDIA CORPORATION & AFFILIATES.
 * All rights reserved.
 * SPDX-License-Identifier: BSD-3-Clause
-->
<section class="tex2jax_ignore mathjax_ignore" id="divisibility-of-split">
<h1>Divisibility of Split<a class="headerlink" href="#divisibility-of-split" title="Link to this heading"></a></h1>
<blockquote>
<div><p>[!NOTE]
We use <span class="math notranslate nohighlight">\(\div\)</span> for true division, and <span class="math notranslate nohighlight">\(/\)</span> for Euclidean division. For example, <span class="math notranslate nohighlight">\(5\div 2 = 2.5\)</span>, <span class="math notranslate nohighlight">\(5/2=2\)</span>.</p>
</div></blockquote>
<blockquote>
<div><p>[!WARNING]
In this documentation, we use Euclidean division instead of truncation division for its better mathematical properties.
Please note that, as described in <a class="reference internal" href="#../math/integer-division.md"><span class="xref myst">Integer Division</span></a>, Euclidean division is different from C++’s truncation division <code class="docutils literal notranslate"><span class="pre">/</span></code> for negative numbers.
Today, indices and extents of all IterDomains are <span class="math notranslate nohighlight">\(\ge 0\)</span>, so we do not need to worry about the difference of variants of divisions.
However, if in the future, we want to allow negative indices/extents, we need to make sure that our generated indices are using Euclidean division as well,
for example, the indexing of <code class="docutils literal notranslate"><span class="pre">Merge</span></code> should be <code class="docutils literal notranslate"><span class="pre">euclideanDiv(i,</span> <span class="pre">N)</span></code>, and <code class="docutils literal notranslate"><span class="pre">euclideanMod(i,</span> <span class="pre">N)</span></code> instead of the native <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">/</span> <span class="pre">N</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">%</span> <span class="pre">N</span></code> in C++,
otherwise some theorems in this document will fail.</p>
</div></blockquote>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>In nvFuser, <code class="docutils literal notranslate"><span class="pre">Split</span></code> is an IterDomain expression that partitions the original IterDomain with extent <span class="math notranslate nohighlight">\(N\)</span> into nested sub-IterDomains with extents <span class="math notranslate nohighlight">\(N_o\)</span>, <span class="math notranslate nohighlight">\(N_i\)</span> (<span class="math notranslate nohighlight">\(N_o N_i \ge N\)</span>),
where the outer IterDomain iterates over <span class="math notranslate nohighlight">\(N_o\)</span> and the inner IterDomain iterates <span class="math notranslate nohighlight">\(N_i\)</span>.
Typically, one of <span class="math notranslate nohighlight">\(N_o\)</span> and <span class="math notranslate nohighlight">\(N_i\)</span> is given by the user, and the other is computed as the <code class="docutils literal notranslate"><span class="pre">ceilDiv</span></code> of <span class="math notranslate nohighlight">\(N\)</span> with the given extent.
The index of the original IterDomain <span class="math notranslate nohighlight">\(i\)</span> is computed from the indices of the outputs of split <span class="math notranslate nohighlight">\(i_o\)</span> and <span class="math notranslate nohighlight">\(i_i\)</span> by <span class="math notranslate nohighlight">\(i = i_o \times N_i + i_i\)</span>.</p>
<p>For example, suppose that I have an IterDomain <code class="docutils literal notranslate"><span class="pre">I0</span></code> whose extent is <code class="docutils literal notranslate"><span class="pre">6</span></code>.
It is helpful to think of this IterDomain as the following loop:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>If I do a <code class="docutils literal notranslate"><span class="pre">Split(I0,</span> <span class="pre">2)</span></code> on this IterDomain, I will get two IterDomains whose extents are <code class="docutils literal notranslate"><span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>.
It is helpful to think of these two IterDomains as two nested loops:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i1</span><span class="p">)</span>
</pre></div>
</div>
<p>If the split is divisible, everything is simple and elegant like above.
However, when splits are indivisible, things start to get complicated.
For example, let’s still consider the <code class="docutils literal notranslate"><span class="pre">I0</span></code> as an example.
But this time, we do a <code class="docutils literal notranslate"><span class="pre">Split(I0,</span> <span class="pre">4)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Split(I0,</span> <span class="pre">2)</span></code>.
With <code class="docutils literal notranslate"><span class="pre">Split(I0,</span> <span class="pre">4)</span></code>, we will get two IterDomains whose extents are <code class="docutils literal notranslate"><span class="pre">2</span></code> (<code class="docutils literal notranslate"><span class="pre">ceilDiv(6,</span> <span class="pre">4)</span></code>) and <code class="docutils literal notranslate"><span class="pre">4</span></code>.
These two extents can be think of as two nested loops:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i0</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i1</span><span class="p">)</span>
</pre></div>
</div>
<p>But wait, is this correct? No, this is not.
Because now we are printing <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span> <span class="pre">5</span> <span class="pre">6</span> <span class="pre">7</span></code> instead of <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span> <span class="pre">5</span></code>.</p>
<p>That is, whenever we do an indivisible split on an IterDomain, we effectively changed its range as well.
We call this added extra range “<em>holes</em>”.
In the above example, the indivisible split creates two holes in <code class="docutils literal notranslate"><span class="pre">I0</span></code>.
In contrast to the concept “holes”, we call the items in the original range “<em>valid items</em>”.</p>
<p>To maintain program semantics, we must add predicates checking whether we are at a valid item or at a hole:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes it can be helpful to consider indivisible split as resize + divisible split.
For example, I can consider <code class="docutils literal notranslate"><span class="pre">Split(I{6},</span> <span class="pre">4)</span></code> as <code class="docutils literal notranslate"><span class="pre">DivisibleSplit(Resize(I{6},</span> <span class="pre">0,</span> <span class="pre">2),</span> <span class="pre">4)</span></code>.
This way, hole creation and loop transformations are separated:
<code class="docutils literal notranslate"><span class="pre">Resize(I{6},</span> <span class="pre">0,</span> <span class="pre">2)</span></code> append two holes to <code class="docutils literal notranslate"><span class="pre">I{6}</span></code> to make it <code class="docutils literal notranslate"><span class="pre">I{8}</span></code>,
and <code class="docutils literal notranslate"><span class="pre">DivisibleSplit</span></code> just view the 1D valid items + holes altogether as 2D.
Visually, this is as shown in Figure 1 below:</p>
<p><img alt="Figure 1" src="../_images/allocate-6-as-2%2C4.svg" /></p>
<p>When we iterate, we iterate on both valid items and holes.
During iteration, when we are at a hole, the index of the some IterDomain will be outside its valid interval <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">extent)</span></code>.
When this happens, we say the index of that IterDomain is “<em>out of boundary</em>”.</p>
</section>
<section id="predication">
<h2>Predication<a class="headerlink" href="#predication" title="Link to this heading"></a></h2>
<p>As we have seen above, indivisible splits create holes in the iteration,
therefore predicates must be introduced.
Let’s consider the following example in Figure 2:</p>
<p><img alt="Figure 2: Three Indivisible Splits" src="../_images/three-indivisible-splits.svg" /></p>
<p>In this example, there are three indivisible splits.
The indices of the inputs of all these splits, <code class="docutils literal notranslate"><span class="pre">i0</span></code>, <code class="docutils literal notranslate"><span class="pre">i1</span></code>, and <code class="docutils literal notranslate"><span class="pre">i2</span></code>, could potentially run out of boundary.</p>
<p>In order to maintain program semantics, the safest predication strategy is to predicate on all these three IterDomains:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i4</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i5</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i6</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">i3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i4</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">i5</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i6</span>
                <span class="n">i0</span> <span class="o">=</span> <span class="p">(</span><span class="n">i3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="n">i5</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i6</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i1</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">i2</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">i0</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span>
</pre></div>
</div>
<p>and this indeed works correctly.</p>
<p>Can this be simplified? What if we just predicate <code class="docutils literal notranslate"><span class="pre">i0</span></code> and nothing else?
We will get <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span> <span class="pre">5</span> <span class="pre">6</span> <span class="pre">7</span> <span class="pre">6</span> <span class="pre">7</span> <span class="pre">8</span> <span class="pre">9</span> <span class="pre">10</span> <span class="pre">11</span> <span class="pre">12</span> <span class="pre">13</span> <span class="pre">12</span> <span class="pre">13</span> <span class="pre">14</span></code>.
We do print the correct set of values, but we are printing some values multiple times.
If all we care is to print the correct set of values, and we don’t mind whether there are duplicates, this can be one strategy.
But this is clearly not equivalent to the program prior to transformation.</p>
<p>From the above example, we can see that overflow of an intermediate IterDomain does not necessarily results in an overflow of their ancestors.
To maintain program semantics, the predicate we use must be logically equivalent to predicating all holes.</p>
<p>The following theorems are useful tools to find mathematically simple predicates that are logically equivalent to predicating all holes:</p>
<p><strong>Theorem 1</strong> Suppose that there is a split <code class="docutils literal notranslate"><span class="pre">I1,</span> <span class="pre">I2</span> <span class="pre">=</span> <span class="pre">Split(I0)</span></code>.
Then “the indices of <code class="docutils literal notranslate"><span class="pre">I0</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are in boundary” implies “the index of <code class="docutils literal notranslate"><span class="pre">I1</span></code> is in boundary”.</p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p>Suppose the indices and extents of <code class="docutils literal notranslate"><span class="pre">I0</span></code>, <code class="docutils literal notranslate"><span class="pre">I1</span></code>, and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are <span class="math notranslate nohighlight">\(i_0\)</span>, <span class="math notranslate nohighlight">\(i_1\)</span>, <span class="math notranslate nohighlight">\(i_2\)</span>, <span class="math notranslate nohighlight">\(N_0\)</span>, <span class="math notranslate nohighlight">\(N_1\)</span>, and <span class="math notranslate nohighlight">\(N_2\)</span>.
Then <span class="math notranslate nohighlight">\(i_0 = i_1 \times N_2 + i_2\)</span>.
“the indices of <code class="docutils literal notranslate"><span class="pre">I0</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are in boundary” means <span class="math notranslate nohighlight">\(0 \le i_0 &lt; N_0\)</span> and <span class="math notranslate nohighlight">\(0 \le i_2 &lt; N_2\)</span>.</p>
<p><em>Upper bound:</em></p>
<p>Because <span class="math notranslate nohighlight">\(i_2 \ge 0\)</span> and <span class="math notranslate nohighlight">\(i_0 &lt; N_0 \)</span>, we have
$<span class="math notranslate nohighlight">\(i_1 \times N_2 &lt; N_0\)</span><span class="math notranslate nohighlight">\(
which is equivalent to
\)</span><span class="math notranslate nohighlight">\(i_1 &lt; N_0 \div N_2\)</span><span class="math notranslate nohighlight">\(
Note that because \)</span>N_1 N_2 \ge N_0<span class="math notranslate nohighlight">\(, we have \)</span>N_0 \div N_2 \le N_1<span class="math notranslate nohighlight">\(.
Therefore,
\)</span><span class="math notranslate nohighlight">\(i_1 &lt; N_1\)</span>$</p>
<p><em>Lower bound:</em></p>
<p>Consider the Euclidean division <span class="math notranslate nohighlight">\(f(x) = x / N_2\)</span>, because <span class="math notranslate nohighlight">\(N_2 &gt; 0\)</span>, <span class="math notranslate nohighlight">\(f(x)\)</span> is weakly increasing.
According to Lemma 2 in <code class="docutils literal notranslate"><span class="pre">[Simplification</span> <span class="pre">of</span> <span class="pre">boolean</span> <span class="pre">predicates]</span></code> in <code class="docutils literal notranslate"><span class="pre">csrc/expr_simplifier.h</span></code>,
(TODO: move this theorem to a md file)
$<span class="math notranslate nohighlight">\(0 \le i_0 \implies f(0) \le f(i_0) \Leftrightarrow 0 \le i_0 / N_2\)</span><span class="math notranslate nohighlight">\(
According to Theorem 2.15 in [Integer Division](../math/integer-division.md),
\)</span><span class="math notranslate nohighlight">\(i_0 / N_2 = (i_1 \times N_2 + i_2) / N_2 = (i_1 \times N_2) / N_2 + i_2 / N_2\)</span><span class="math notranslate nohighlight">\(
Because \)</span>0 \le i_2 &lt; N_2<span class="math notranslate nohighlight">\(, we have \)</span>i_2 / N_2 = 0<span class="math notranslate nohighlight">\(.
According to Theorem 2.14 in [Integer Division](../math/integer-division.md),
\)</span><span class="math notranslate nohighlight">\((i_1 \times N_2) / N_2 = i_1 / (N_2 / N_2) = i_1\)</span><span class="math notranslate nohighlight">\(
Therefore
\)</span><span class="math notranslate nohighlight">\(i_0 / N_2 = i_1\)</span><span class="math notranslate nohighlight">\(
That is:
\)</span><span class="math notranslate nohighlight">\(0 \le i_0 \implies 0 \le i_1\)</span><span class="math notranslate nohighlight">\(
\)</span>\square$</p>
</details>
<p>The above theorem tells us that, if we are already predicating <code class="docutils literal notranslate"><span class="pre">I0</span></code>, then there is no need to additionally predicate <code class="docutils literal notranslate"><span class="pre">I1</span></code>.
We can derive similar theorems for other IterDomain expressions:</p>
<p><strong>Theorem 2</strong> Suppose that there is a merge <code class="docutils literal notranslate"><span class="pre">I2</span> <span class="pre">=</span> <span class="pre">Merge(I0,</span> <span class="pre">I1)</span></code>.
Then “the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is in boundary” is equivalent to “the index of <code class="docutils literal notranslate"><span class="pre">I2</span></code> is in boundary”.</p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p>Suppose the index of <code class="docutils literal notranslate"><span class="pre">I2</span></code> is <span class="math notranslate nohighlight">\(i_2\)</span>, the extent of <code class="docutils literal notranslate"><span class="pre">I1</span></code> is <span class="math notranslate nohighlight">\(N_1\)</span>.
Then the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is <span class="math notranslate nohighlight">\(i_0 = i_2 / N_1\)</span>.
Suppose that the extents of <code class="docutils literal notranslate"><span class="pre">I0</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are <span class="math notranslate nohighlight">\(N_0\)</span> and <span class="math notranslate nohighlight">\(N_2\)</span>, then <span class="math notranslate nohighlight">\(N_2 = N_0 \times N_1\)</span>.
“the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is in boundary” means <span class="math notranslate nohighlight">\(0 \le i_0 &lt; N_0\)</span></p>
<p><em>Lower bound:</em></p>
<p>Because <span class="math notranslate nohighlight">\(N_1 &gt; 0\)</span>, it is a property of Euclidean division that <span class="math notranslate nohighlight">\(i_2 / N_1 \ge 0 \Leftrightarrow i_2 \ge 0\)</span>. See:</p>
<blockquote>
<div><p>Boute, Raymond T. “The Euclidean definition of the functions div and mod.” ACM Transactions on Programming Languages and Systems (TOPLAS) 14.2 (1992): 127-144.</p>
</div></blockquote>
<p>Note that truncation division does not have this property.</p>
<p><em>Upper bound:</em></p>
<p>According to Theorem 2.16 in <a class="reference internal" href="#../math/integer-division.md"><span class="xref myst">Integer Division</span></a>,
$<span class="math notranslate nohighlight">\(i_2 / N_1 &lt; N_0 \Leftrightarrow i_2 &lt; N_0 \times N_1 \Leftrightarrow i_2 &lt; N_2\)</span><span class="math notranslate nohighlight">\(
\)</span>\square$</p>
</details>
<p><strong>Theorem 3</strong> Suppose that there is a resize <code class="docutils literal notranslate"><span class="pre">I1</span> <span class="pre">=</span> <span class="pre">Resize(I0,</span> <span class="pre">L,</span> <span class="pre">R)</span></code>.
Then “the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is in boundary” implies “the index of <code class="docutils literal notranslate"><span class="pre">I1</span></code> is in boundary” if <span class="math notranslate nohighlight">\(L \ge 0\)</span> and <span class="math notranslate nohighlight">\(R \ge 0\)</span>.</p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p>Suppose the index of <code class="docutils literal notranslate"><span class="pre">I1</span></code> is <span class="math notranslate nohighlight">\(i_1\)</span>, the extent of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is <span class="math notranslate nohighlight">\(N_0\)</span>.
The index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is then <span class="math notranslate nohighlight">\(i_0 = i_1 - L\)</span>.
The extent of <code class="docutils literal notranslate"><span class="pre">I1</span></code> is <span class="math notranslate nohighlight">\(N_0 + L + R\)</span>.
“the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is in boundary” means <span class="math notranslate nohighlight">\(0 \leq i_0 &lt; N_0\)</span>.</p>
<p><em>Lower bound:</em></p>
<p>Because <span class="math notranslate nohighlight">\(L \ge 0\)</span>,
$<span class="math notranslate nohighlight">\(i_0 \ge 0 \Leftrightarrow i_1 \ge L \implies i_1 \ge 0\)</span>$</p>
<p><em>Upper bound:</em></p>
<p>Because <span class="math notranslate nohighlight">\(R \ge 0\)</span>,
$<span class="math notranslate nohighlight">\(i_0 &lt; N \Leftrightarrow i_1 &lt; N_0 + L \implies i_1 &lt; N + L + R\)</span><span class="math notranslate nohighlight">\(
\)</span>\square$</p>
</details>
<p><strong>Theorem 4</strong> Suppose that there is a swizzle <code class="docutils literal notranslate"><span class="pre">I2,</span> <span class="pre">I3</span> <span class="pre">=</span> <span class="pre">Swizzle(I0,</span> <span class="pre">I1)</span></code>.
Then “the index of <code class="docutils literal notranslate"><span class="pre">I0</span></code> is in boundary” is equivalent to “the index of <code class="docutils literal notranslate"><span class="pre">I2</span></code> is in boundary”.</p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p><code class="docutils literal notranslate"><span class="pre">I0</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> also have the same extents and indices.
<span class="math notranslate nohighlight">\(\square\)</span></p>
</details>
</section>
<section id="allocation-and-correctness-model">
<h2>Allocation and correctness model<a class="headerlink" href="#allocation-and-correctness-model" title="Link to this heading"></a></h2>
<p>Indivisible split also impact the allocation size.</p>
<p>For example, if I have a tensor <code class="docutils literal notranslate"><span class="pre">T0[I0{6}]</span></code>, when allocating this tensor,
I will allocate 6 items for this tensor.
If I do an indivisible split on <code class="docutils literal notranslate"><span class="pre">I0{6}</span></code> by <code class="docutils literal notranslate"><span class="pre">4</span></code> to get <code class="docutils literal notranslate"><span class="pre">I1{2}</span></code> and <code class="docutils literal notranslate"><span class="pre">I2{4}</span></code>,
and set the allocation domain of this tensor as <code class="docutils literal notranslate"><span class="pre">[I1,</span> <span class="pre">I2]</span></code>,
then I will need to allocate <code class="docutils literal notranslate"><span class="pre">2*4</span> <span class="pre">=</span> <span class="pre">8</span></code> items.</p>
<p>We call the above situation <em>over-allocated</em>, that is,
we are not only allocating valid items, but also allocating holes.</p>
<p>Because there are holes in the allocation due to indivisible split,
a natural question to ask is: When we write to an over-allocated buffer,
what value should we fill these holes as?
Possible answers are:</p>
<ol class="arabic simple">
<li><p>As long as there is no “Illegal Memory Access” killing my kernel,
I don’t care about what values these holes have.</p></li>
<li><p>The holes should be filled with 0.</p></li>
<li><p>The holes should be filled with x (something different from zero).</p></li>
</ol>
<p>Which answer is correct? There is no certain answer.
It totally depends on how these values are read:
If the holes are never read, then 1, 2, or 3 makes no difference.
If the holes are actually read,
then it needs to be filled with some neutral value that effectively leads to a no-op.
For example, if we are doing an unpredicated reduction on an over-allocated buffer,
such as when using tensor core, we must fill the holes correctly.
If the reduction is sum, then the holes must be filled with 0.
If the reduction is product, then the holes must be filled with 1.
This inspires the concept of weak and strong correctness:</p>
<p><strong>Definition 1:</strong> A schedule/lowering strategy is weakly correct if all the valid items in the consumer’s allocation domain are filled with the correct value,
and there is no error raise in the kernel.</p>
<p><strong>Definition 2:</strong> A schedule/lowering strategy is strongly correct if all the valid items in the consumer’s allocation domain are filled with the correct value,
and all holes are filled with a desired filling value.</p>
</section>
<section id="properties-of-split">
<h2>Properties of split<a class="headerlink" href="#properties-of-split" title="Link to this heading"></a></h2>
<section id="merge-then-split-vs-split-then-merge">
<h3>Merge-then-split vs split-then-merge<a class="headerlink" href="#merge-then-split-vs-split-then-merge" title="Link to this heading"></a></h3>
<p><strong>Theorem 5:</strong> Suppose that there are two IterDomains <code class="docutils literal notranslate"><span class="pre">I1</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code>,
the following two combinations of merge and split in the Figure 3 below are equivalent if and only if the split is divisible</p>
<p><img alt="Figure 3: Merge-then-split vs split-then-merge" src="../_images/merge-split1.svg" /></p>
<details>
<p><strong><summary>Proof:</summary></strong></p>
<p><em>If the split is indivisible, these two transformations are not equivalent:</em></p>
<p>We can see this from a simple example where there is a tensor <code class="docutils literal notranslate"><span class="pre">T[I1,</span> <span class="pre">I2]</span></code>,
<code class="docutils literal notranslate"><span class="pre">I1</span></code> has extent <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">I2</span></code> has extent <code class="docutils literal notranslate"><span class="pre">5</span></code>, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p>For transformation 1, after schedule, the extents of the loop domain <code class="docutils literal notranslate"><span class="pre">[I4,</span> <span class="pre">I5]</span></code> will be <code class="docutils literal notranslate"><span class="pre">[2*2,</span> <span class="pre">4]</span></code>.
We will be iterating the tensor as the following Listing 1:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p>For transformation 2, after schedule, the extents of the loop domain <code class="docutils literal notranslate"><span class="pre">[I4,</span> <span class="pre">I5]</span></code> will be <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">4]</span></code>.
We will be iterating the tensor as as the following Listing 2:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>They are clearly not equivalent.</p>
<p><em>If the split is divisible, the two transformations are equivalent:</em></p>
<p>Let’s say the extents of <code class="docutils literal notranslate"><span class="pre">I1</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are <span class="math notranslate nohighlight">\(N_1\)</span> and <span class="math notranslate nohighlight">\(N_2\)</span>, and the split size is <span class="math notranslate nohighlight">\(N\)</span>.
Being divisible means <span class="math notranslate nohighlight">\(N\)</span> divide <span class="math notranslate nohighlight">\(N_2\)</span>.</p>
<p>The extent of <code class="docutils literal notranslate"><span class="pre">I4</span></code> of transformation 1 is <span class="math notranslate nohighlight">\(N_1 \times (N_2 \div N)\)</span>,
which is the same as transformation 2’s <code class="docutils literal notranslate"><span class="pre">I4</span></code>’s extent <span class="math notranslate nohighlight">\((N_1 \times N_2) \div N\)</span>.
The extents of <code class="docutils literal notranslate"><span class="pre">I5</span></code> in transformations 1 and 2 are all <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>Assume the indices of <code class="docutils literal notranslate"><span class="pre">I4</span></code> and <code class="docutils literal notranslate"><span class="pre">I5</span></code> are <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>In schedule 1, the indices of <code class="docutils literal notranslate"><span class="pre">I1</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are
<span class="math notranslate nohighlight">\(i/(N_2 / N)\)</span> and <span class="math notranslate nohighlight">\(i \mathbin{\\%} (N_2 / N) \times N + j\)</span>.
According to Theorem 2.10 in <a class="reference internal" href="#../math/integer-division.md"><span class="xref myst">Integer Division</span></a>,
$<span class="math notranslate nohighlight">\(i/(N_2 / N) = (i \times N) / N_2\)</span><span class="math notranslate nohighlight">\(
According to Theorem 2.13 in [Integer Division](../math/integer-division.md),
\)</span><span class="math notranslate nohighlight">\(i \mathbin{\\%} (N_2 / N) \times N + j = (i \times N) \mathbin{\\%} N_2  + j\)</span>$</p>
<p>In schedule 2, the indices of <code class="docutils literal notranslate"><span class="pre">I1</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> are
<span class="math notranslate nohighlight">\((i \times N + j) / N_2\)</span> and <span class="math notranslate nohighlight">\((i \times N + j) \mathbin{\\%} N_2\)</span>.
According to Theorem 2.7.2, 2.15.2 in <a class="reference internal" href="#../math/integer-division.md"><span class="xref myst">Integer Division</span></a>,
$<span class="math notranslate nohighlight">\((i \times N + j) / N_2 = (i \times N) / N_2\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\((i \times N + j) \mathbin{\\%} N_2 = (i \times N) \mathbin{\\%} N_2  + j\)</span>$</p>
<p>We can see that <code class="docutils literal notranslate"><span class="pre">I1</span></code> and <code class="docutils literal notranslate"><span class="pre">I2</span></code> has the same indices, they are therefore equivalent.
<span class="math notranslate nohighlight">\(\square\)</span></p>
</details>
</section>
<section id="merging-discontiguous-iterdomains">
<h3>Merging discontiguous IterDomains<a class="headerlink" href="#merging-discontiguous-iterdomains" title="Link to this heading"></a></h3>
<section id="question">
<h4>Question<a class="headerlink" href="#question" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Q1: Can I merge two discontiguous IterDomains to create a larger IterDomain, and split out a vectorization IterDomain from this larger IterDomain?</p></li>
<li><p>Q2: In TMA scheduling, can I create the TMA domain by merging two discontiguous IterDomains, and then split out a box?</p></li>
</ul>
</section>
<section id="answer">
<h4>Answer<a class="headerlink" href="#answer" title="Link to this heading"></a></h4>
<p>The answer is yes if and only if the split size divide the extent of the inner IterDomain of the merge.</p>
<p>If we merge discontiguous IterDomains then do a split that does not divide the inner extent,
we will end up iterating the tensor like transformation 2 in the <a class="reference internal" href="#merge-then-split-vs-split-then-merge"><span class="xref myst">above example</span></a>.
From the Listing 2 there, we see that after <code class="docutils literal notranslate"><span class="pre">T[0,</span> <span class="pre">4]</span></code>, we should be accessing <code class="docutils literal notranslate"><span class="pre">T[1,</span> <span class="pre">0]</span></code>,
which is not contiguous to <code class="docutils literal notranslate"><span class="pre">T[0,</span> <span class="pre">4]</span></code> in memory.
However, vectorization and TMA can only access memory contiguously.</p>
<p>If divisible, then the merge-then-split is equivalent to a split-then-merge, which is totally valid.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api/pod_class.html" class="btn btn-neutral float-left" title="Data classes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iterdomain.html" class="btn btn-neutral float-right" title="The Mathematical Theory of IterDomain" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
<img src="../_static/NVIDIA-LogoBlack.svg"/>
<p class="notices">
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" target="_blank">Privacy Policy</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" target="_blank">Manage My Privacy</a>
|
<a href="https://www.nvidia.com/en-us/preferences/start/" target="_blank">Do Not Sell or Share My Data</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" target="_blank">Terms of Service</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" target="_blank">Accessibility</a>
|
<a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" target="_blank">Corporate Policies</a>
|
<a href="https://www.nvidia.com/en-us/product-security/" target="_blank">Product Security</a>
|
<a href="https://www.nvidia.com/en-us/contact/" target="_blank">Contact</a>
</p>

    <p>&#169; Copyright 2023-2025, NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved..</p>

  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
        Version: 0.2.34
        
    </span>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>