[1m====================================================================================================== test session starts ======================================================================================================[0m
platform linux -- Python 3.12.3, pytest-8.3.5, pluggy-1.6.0
Test order randomisation NOT enabled. Enable with --random-order or --random-order-bucket=<bucket_type>
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /opt/pytorch/nvfuser
plugins: timeout-2.4.0, xdist-3.7.0, random-order-1.2.0, cov-6.2.1, timestamper-0.0.10, shard-0.1.2, benchmark-5.1.0, hypothesis-6.136.6, mpi-0.6
[1mcollecting ... [0m[1mcollecting 3 items                                                                                                                                                                                                              [0m[1mcollected 3 items / 2 deselected / 1 selected                                                                                                                                                                                   [0m
Running 1 items in this shard

tests/python/multidevice/test_transformer.py Segment the fusion (Original Fusion Un-modified): 
Inputs:
  i0
  i1
  T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1})
  T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1})
  T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1})
  i22
  i23
  T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1})
  T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1})
  T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1})
  T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1})
  T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1})
  T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1})
  T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1})
  T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1})
  T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1})
  T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1})
  T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1})
  T14_g_uint64_t[] (DeviceMesh{0 1})
  T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1})
  T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1})
  T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1})
  T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
  T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1})
  T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1})
Outputs:
  T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1})
  T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1})
  T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1})
  T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1})
  T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1})
  T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1})
  T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1})
  T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1})
  T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1})
  T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1})
  T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1})
  T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1})
  T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})

%kernel_math {
T21_l___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i1);
T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T21_l___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1}));
T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1})
   = T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   = __to_float(T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1}));
T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}));
T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1});
T30_l_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1})
   = T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   * T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1});
T32_l___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T30_l_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}));
T34_l___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1})
   = squeeze( T32_l___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T254_l___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1})
   = Set.Permute( T34_l___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1}));
T41_l_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T26_l_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1})
   = T26_l_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1});
T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   + T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1});
T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1});
T37_l_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   = tanhf(T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1}));
T45_l_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   = double(1)
   + T37_l_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
T221_l_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1})
   = T41_l_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T45_l_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1});
T229_l___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T221_l_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1}));
T253_l___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1})
   = squeeze( T229_l___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1})
   = matmul(T254_l___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1}),
            T253_l___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1}))
T251_l_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1})
   = squeeze( T30_l_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T252_l_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1})
   = reduction( T251_l_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T252_l_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1}));
T36_l___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1})
   = matmul(T34_l___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}),
            T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1}))
T38_l___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1})
   = broadcast( T36_l___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T38_l___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1}));
T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   = T41_l_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1})
   = T37_l_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   * T37_l_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1})
   = double(1)
   - T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1});
T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1})
   = T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   * T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1});
T46_l_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1});
T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1})
   = T45_l_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1});
T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   = T46_l_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   + T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1});
T48_l_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T46_l_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1});
T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1})
   = T26_l_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T48_l_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   = T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   + T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1});
T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T48_l_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
T53_l_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1});
T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   = T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   + T53_l_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
T56_l_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1})
   = T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   + T53_l_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
T58_l___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T56_l_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}));
T61_l___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1})
   = squeeze( T58_l___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T250_l___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1})
   = Set.Permute( T61_l___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}), cache_op=Streaming )
T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
T63_l_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1}));
T57_l___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i23);
T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T57_l___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1}));
T60_l_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1})
   = T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   = __to_float(T60_l_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1}));
T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   = T63_l_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   * T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1});
T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1})
   = T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   * double(1.11111);
T78_l_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   = T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   + T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1});
T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T71_l_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1})
   = Set( T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T77_l_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1}) = expand( T71_l_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T80_l_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   = T78_l_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T77_l_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1});
T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1})
   = Set( T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T87_l_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1}) = expand( T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T209_l_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   = T80_l_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T87_l_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1});
T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1})
   = broadcast( T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T69_l___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}) = expand( T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T69_l___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}));
T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   = T209_l_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1});
T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1})
   = broadcast( T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T208_l___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}) = expand( T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T208_l___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}));
T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1})
   = T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   + T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1});
T228_l___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1}));
T249_l___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1})
   = squeeze( T228_l___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1})
   = matmul(T250_l___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1}),
            T249_l___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1}))
T247_l_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1})
   = squeeze( T56_l_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T248_l_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1})
   = reduction( T247_l_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T248_l_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1}));
T64_l___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1})
   = matmul(T61_l___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}),
            T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1}))
T65_l___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1})
   = reduction( T64_l___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
T67_l___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1})
   = broadcast( T65_l___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T67_l___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1}));
T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1})
   = squeeze( T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T246_l_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1})
   = reduction( T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T246_l_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1}));
T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1})
   = T209_l_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1})
   = squeeze( T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T244_l_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1})
   = reduction( T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T244_l_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1}));
T79_l_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1})
   = T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
T90_l_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   = T87_l_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1})
   * T79_l_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1})
   = -T90_l_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1});
T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1})
   = squeeze( T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T95_l_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1})
   = reduction( T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1})
   = broadcast( T95_l_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T117_l_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1}) = expand( T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T119_l_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T117_l_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1});
T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1})
   = T80_l_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T79_l_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1})
   = squeeze( T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T83_l_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1})
   = reduction( T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1})
   = broadcast( T83_l_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T89_l_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1});
T88_l_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1})
   = pow(T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1})
  , double(3));
T91_l_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1})
   = T89_l_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   * T88_l_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1});
T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1}) = expand( T91_l_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T112_l_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1});
T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T101_l_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1})
   = Set( T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T106_l_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1}) = expand( T101_l_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T111_l_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1})
   = T78_l_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T106_l_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1});
T115_l_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   = T112_l_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   * T111_l_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1});
d586 = reciprocal(double(12288));
T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1})
   = T115_l_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   * d586;
T120_l_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1})
   = T119_l_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   + T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1});
T121_l_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1})
   = T90_l_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   + T120_l_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1});
T122_l_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   = T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1})
   + T121_l_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1});
T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T122_l_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1});
T124_l_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1})
   = T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   * T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1});
T125_l___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T124_l_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}));
T126_l___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1})
   = squeeze( T125_l___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T242_l___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1})
   = Set.Permute( T126_l___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1})
   = Set.Permute( T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T219_l___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1})
   = Set( T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T226_l___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}) = view( T219_l___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1}) )
T241_l___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1})
   = squeeze( T226_l___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1})
   = matmul(T242_l___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1}),
            T241_l___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1}))
T239_l_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1})
   = squeeze( T124_l_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T240_l_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1})
   = reduction( T239_l_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T240_l_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1}));
T127_l___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1})
   = matmul(T126_l___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}),
            T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1}))
T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1})
   = broadcast( T127_l___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T135_l___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}) = view( T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1}) )
T139_l___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1})
   = Set.Permute( T135_l___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {0, 6144, 1} } )
T134_l___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}) = view( T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1}) )
T138_l___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1})
   = Set.Permute( T134_l___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {6144, 12288, 1} } )
T133_l___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}) = view( T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1}) )
T137_l___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1})
   = Set.Permute( T133_l___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {12288, 18432, 1} } )
T132_l___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}) = view( T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1}) )
T136_l___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1})
   = Set.Permute( T132_l___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T140_l___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}),
T141_l___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}),
T142_l___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1})
   = sdpa_bwd(T139_l___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1}),
            T138_l___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1}),
            T137_l___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1}),
            T136_l___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1}),
            T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}),
            logsum_exp = T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1}),
            dropout_p = double(0.10000000000000001),
            is_causal = true,
            philox_seed = T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1}),
            philox_offset = T14_g_uint64_t[] (DeviceMesh{0 1}),
  )
T145_l___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1})
   = Set.Permute( T140_l___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T148_l___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}) = view( T145_l___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1}) )
T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1})
   = pad( T148_l___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, 0, 12288} )
T144_l___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1})
   = Set.Permute( T141_l___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T147_l___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}) = view( T144_l___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1}) )
i834 = 0 + 6144;
T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T147_l___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i834, 6144} )
T143_l___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1})
   = Set.Permute( T142_l___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T146_l___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}) = view( T143_l___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1}) )
i849 = i834 + 6144;
T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T146_l___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i849, 0} )
T152_l___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1})
   = cat( T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1}), T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), 3 )
T153_l___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1})
   = squeeze( T152_l___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T238_l___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1})
   = Set.Permute( T153_l___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}), cache_op=Streaming )
T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1})
   = Set( T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1}) = expand( T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T166_l_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   = T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   - T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1});
T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1})
   = Set( T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T173_l_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1}) = expand( T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T206_l_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   = T166_l_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T173_l_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1});
T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1})
   = broadcast( T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T158_l___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}) = expand( T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T158_l___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}));
T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   = T206_l_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1});
T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1})
   = broadcast( T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T205_l___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}) = expand( T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T205_l___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}));
T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1})
   = T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   + T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1});
T225_l___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1}));
T237_l___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1})
   = squeeze( T225_l___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1})
   = matmul(T238_l___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1}),
            T237_l___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1}))
T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1})
   = __bfloat2float(T152_l___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}));
T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1})
   = squeeze( T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T236_l_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1})
   = reduction( T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1})
   = __float2bfloat(T236_l_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1}));
T154_l___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1})
   = matmul(T153_l___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}),
            T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1}))
T155_l___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1})
   = reduction( T154_l___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
T156_l___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1})
   = broadcast( T155_l___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T156_l___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1}));
T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1})
   = squeeze( T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T234_l_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1})
   = reduction( T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T234_l_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1}));
T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1})
   = T206_l_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1})
   = squeeze( T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T232_l_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1})
   = reduction( T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T232_l_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1}));
T165_l_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1})
   = T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
T176_l_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   = T173_l_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1})
   * T165_l_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1})
   = -T176_l_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1});
T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1})
   = squeeze( T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T181_l_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1})
   = reduction( T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1})
   = broadcast( T181_l_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T203_l_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1}) = expand( T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T211_l_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T203_l_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1});
T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1})
   = T166_l_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T165_l_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1})
   = squeeze( T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T169_l_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1})
   = reduction( T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1})
   = broadcast( T169_l_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T175_l_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1});
T174_l_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1})
   = pow(T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
  , double(3));
T177_l_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1})
   = T175_l_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   * T174_l_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1});
T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1}) = expand( T177_l_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T198_l_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1});
T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T187_l_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1})
   = Set( T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T192_l_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1}) = expand( T187_l_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T197_l_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1})
   = T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   - T192_l_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1});
T201_l_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   = T198_l_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   * T197_l_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1});
d1089 = reciprocal(double(12288));
T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1})
   = T201_l_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   * d1089;
T217_l_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1})
   = T211_l_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   + T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1});
T222_l_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1})
   = T176_l_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   + T217_l_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1});
T230_l_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1})
   = T122_l_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   + T222_l_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1});
T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T230_l_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1}));
} // %kernel_math 

Segmented_Fusion Dump: -- Re-written complete fusion:{
Inputs:
  i0
  i1
  T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1})
  T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1})
  T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1})
  i22
  i23
  T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1})
  T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1})
  T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1})
  T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1})
  T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1})
  T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1})
  T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1})
  T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1})
  T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1})
  T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1})
  T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1})
  T14_g_uint64_t[] (DeviceMesh{0 1})
  T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1})
  T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1})
  T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1})
  T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
  T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1})
  T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1})
Outputs:
  T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1})
  T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1})
  T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1})
  T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1})
  T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1})
  T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1})
  T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1})
  T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1})
  T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1})
  T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1})
  T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1})
  T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1})
  T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})

%kernel_math {
T21_g___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i1);
T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T21_g___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1}));
T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1})
   = T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   = __to_float(T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1}));
T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}));
T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1});
T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1})
   = T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   * T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1});
T32_g___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}));
T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1})
   = squeeze( T32_g___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1})
   = Set.Permute( T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1}));
T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1})
   = T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1});
T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   + T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1});
T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1});
T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   = tanhf(T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1}));
T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   = double(1)
   + T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
T221_g_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1})
   = T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1});
T229_g___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T221_g_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1}));
T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1})
   = squeeze( T229_g___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1})
   = matmul(T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1}),
            T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1}))
T251_g_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1})
   = squeeze( T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T252_g_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1})
   = reduction( T251_g_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T252_g_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1}));
T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1})
   = matmul(T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}),
            T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1}))
T38_g___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1})
   = broadcast( T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T38_g___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1}));
T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   = T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1})
   = T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   * T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1})
   = double(1)
   - T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1});
T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1})
   = T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   * T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1});
T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1});
T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1})
   = T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1});
T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   = T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   + T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1});
T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1});
T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1})
   = T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   = T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   + T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1});
T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1});
T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   = T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   + T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1})
   = T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   + T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
T58_g___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}));
T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1})
   = squeeze( T58_g___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1})
   = Set.Permute( T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}), cache_op=Streaming )
T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
T63_g_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1}));
T57_g___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i23);
T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T57_g___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1}));
T60_g_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1})
   = T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   = __to_float(T60_g_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1}));
T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   = T63_g_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   * T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1});
T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1})
   = T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   * double(1.11111);
T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   = T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   + T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1});
T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T71_g_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1})
   = Set( T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T77_g_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1}) = expand( T71_g_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   = T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T77_g_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1});
T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1})
   = Set( T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1}) = expand( T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   = T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1});
T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1})
   = broadcast( T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T69_g___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}) = expand( T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T69_g___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}));
T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   = T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1});
T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1})
   = broadcast( T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T208_g___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}) = expand( T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T208_g___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}));
T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1})
   = T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   + T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1});
T228_g___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1}));
T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1})
   = squeeze( T228_g___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1})
   = matmul(T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1}),
            T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1}))
T247_g_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1})
   = squeeze( T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T248_g_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1})
   = reduction( T247_g_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T248_g_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1}));
T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1})
   = matmul(T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}),
            T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1}))
T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1})
   = reduction( T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
T67_g___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1})
   = broadcast( T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T67_g___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1}));
T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1})
   = squeeze( T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T246_g_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1})
   = reduction( T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T246_g_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1}));
T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1})
   = T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1})
   = squeeze( T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T244_g_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1})
   = reduction( T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T244_g_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1}));
T285_g_float[bS907{1}, iS908{2048}, iS909{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}));
T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1})
   = T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   = T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1})
   * T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1})
   = -T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1});
T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1})
   = squeeze( T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T95_g_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1})
   = reduction( T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1})
   = broadcast( T95_g_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T117_g_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1}) = expand( T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T119_g_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T117_g_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1});
T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1})
   = T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1})
   = squeeze( T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T83_g_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1})
   = reduction( T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1})
   = broadcast( T83_g_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T89_g_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1});
T88_g_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1})
   = pow(T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1})
  , double(3));
T91_g_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1})
   = T89_g_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   * T88_g_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1});
T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1}) = expand( T91_g_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T112_g_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1});
T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T101_g_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1})
   = Set( T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T106_g_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1}) = expand( T101_g_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T111_g_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1})
   = T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T106_g_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1});
T115_g_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   = T112_g_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   * T111_g_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1});
d586 = reciprocal(double(12288));
T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1})
   = T115_g_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   * d586;
T120_g_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1})
   = T119_g_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   + T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1});
T121_g_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1})
   = T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   + T120_g_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1});
T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   = T285_g_float[bS907{1}, iS908{2048}, iS909{12288}] (DeviceMesh{0 1})
   + T121_g_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1});
T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1});
T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1})
   = T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   * T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1});
T125_g___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}));
T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1})
   = squeeze( T125_g___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1})
   = Set.Permute( T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1})
   = Set.Permute( T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T219_g___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1})
   = Set( T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T226_g___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}) = view( T219_g___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1}) )
T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1})
   = squeeze( T226_g___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1})
   = matmul(T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1}),
            T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1}))
T239_g_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1})
   = squeeze( T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T240_g_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1})
   = reduction( T239_g_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T240_g_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1}));
T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1})
   = matmul(T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}),
            T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1}))
T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1})
   = broadcast( T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T135_g___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}) = view( T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1}) )
T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1})
   = Set.Permute( T135_g___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {0, 6144, 1} } )
T134_g___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}) = view( T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1}) )
T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1})
   = Set.Permute( T134_g___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {6144, 12288, 1} } )
T133_g___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}) = view( T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1}) )
T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1})
   = Set.Permute( T133_g___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {12288, 18432, 1} } )
T132_g___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}) = view( T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1}) )
T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1})
   = Set.Permute( T132_g___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}),
T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}),
T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1})
   = sdpa_bwd(T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1}),
            T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1}),
            T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1}),
            T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1}),
            T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}),
            logsum_exp = T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1}),
            dropout_p = double(0.10000000000000001),
            is_causal = true,
            philox_seed = T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1}),
            philox_offset = T14_g_uint64_t[] (DeviceMesh{0 1}),
  )
T145_g___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1})
   = Set.Permute( T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}) = view( T145_g___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1}) )
T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1})
   = pad( T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, 0, 12288} )
T144_g___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1})
   = Set.Permute( T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}) = view( T144_g___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1}) )
i834 = 0 + 6144;
T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i834, 6144} )
T143_g___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1})
   = Set.Permute( T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1}), cache_op=Streaming )
T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}) = view( T143_g___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1}) )
i849 = i834 + 6144;
T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i849, 0} )
T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1})
   = cat( T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1}), T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), 3 )
T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1})
   = squeeze( T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1})
   = Set.Permute( T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}), cache_op=Streaming )
T287_l_float[bS913{1}, iS914{2048}, iS915{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1})
   = Set( T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1}) = expand( T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   = T287_l_float[bS913{1}, iS914{2048}, iS915{12288}] (DeviceMesh{0 1})
   - T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1});
T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1})
   = Set( T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1}) = expand( T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   = T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1});
T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1})
   = broadcast( T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T158_g___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}) = expand( T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T158_g___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}));
T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   = T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1});
T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1})
   = broadcast( T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
T205_g___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}) = expand( T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T205_g___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}));
T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1})
   = T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   + T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1});
T225_g___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1}));
T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1})
   = squeeze( T225_g___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1})
   = matmul(T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1}),
            T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1}))
T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1})
   = __bfloat2float(T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}));
T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1})
   = squeeze( T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
T236_g_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1})
   = reduction( T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1})
   = __float2bfloat(T236_g_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1}));
T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1})
   = matmul(T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}),
            T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1}))
T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1})
   = reduction( T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
T156_g___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1})
   = broadcast( T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T156_g___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1}));
T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1})
   = squeeze( T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T234_g_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1})
   = reduction( T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T234_g_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1}));
T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1})
   = T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1})
   = squeeze( T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T232_g_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1})
   = reduction( T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T232_g_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1}));
T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1})
   = T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   = T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1})
   * T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1})
   = -T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1});
T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1})
   = squeeze( T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T181_g_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1})
   = reduction( T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1})
   = broadcast( T181_g_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T203_g_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1}) = expand( T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T203_g_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1});
T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1})
   = T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1})
   = squeeze( T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1})
   = reduction( T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1})
   = broadcast( T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
T175_g_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1});
T174_g_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1})
   = pow(T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
  , double(3));
T177_g_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1})
   = T175_g_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   * T174_g_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1});
T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1}) = expand( T177_g_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T198_g_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1});
T291_l_float[bS925{1}, iS926{2048}, iS927{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
T187_g_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1})
   = Set( T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1}), cache_op=Streaming )
T192_g_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1}) = expand( T187_g_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
T197_g_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1})
   = T291_l_float[bS925{1}, iS926{2048}, iS927{12288}] (DeviceMesh{0 1})
   - T192_g_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1});
T201_g_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   = T198_g_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   * T197_g_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1});
d1089 = reciprocal(double(12288));
T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1})
   = T201_g_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   * d1089;
T217_g_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1})
   = T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   + T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1});
T222_g_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1})
   = T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   + T217_g_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1});
T230_g_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1})
   = T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   + T222_g_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1});
T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T230_g_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1}));
} // %kernel_math 

} // {Re-written complete fusion}
Segmented_Fusion Dump: -- fusion segments:
Segmented_Fusion{ 
groups: 
  reduction{2, 3, 4, 6, 7, 9, 11, 13, 250, 251, 253, 265, 285}
  expr_eval{15}
  reduction{1, 10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 34, 35, 37, 40, 219, 228, 246, 247, 249, 252, 263, 63312, 63313, 63314, 63315, 63316, 63317}
  expr_eval{266}
  expr_eval{43}
  communication{44}
  inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321}
  expr_eval{264}
  expr_eval{212, 217, 225, 240}
  expr_eval{260}
  expr_eval{107}
  expr_eval{114, 122, 126}
  expr_eval{113, 120, 125}
  expr_eval{111, 118, 124}
  expr_eval{109, 116, 123}
  expr_eval{127}
  pointwise{130, 136}
  pointwise{129, 134}
  pointwise{128, 132}
  reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257}
  expr_eval{151}
  communication{152}
  reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311}
  expr_eval{258}
  reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339}
  transpose{167, 171, 174, 183, 184, 195, 198, 207, 208, 215, 220, 229, 254, 304, 311, 312, 3007, 3008}
edges: 
  e{ reduction{2, 3, 4, 6, 7, 9, 11, 13, 250, 251, 253, 265, 285} -> expr_eval{266}(T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1})) }
  e{ reduction{2, 3, 4, 6, 7, 9, 11, 13, 250, 251, 253, 265, 285} -> expr_eval{15}(T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1})) }
  e{ expr_eval{15} -> reduction{1, 10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 34, 35, 37, 40, 219, 228, 246, 247, 249, 252, 263, 63312, 63313, 63314, 63315, 63316, 63317}(T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1})) }
  e{ reduction{1, 10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 34, 35, 37, 40, 219, 228, 246, 247, 249, 252, 263, 63312, 63313, 63314, 63315, 63316, 63317} -> expr_eval{266}(T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1})) }
  e{ reduction{1, 10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 34, 35, 37, 40, 219, 228, 246, 247, 249, 252, 263, 63312, 63313, 63314, 63315, 63316, 63317} -> expr_eval{264}(T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1})) }
  e{ reduction{1, 10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 34, 35, 37, 40, 219, 228, 246, 247, 249, 252, 263, 63312, 63313, 63314, 63315, 63316, 63317} -> expr_eval{43}(T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1})) }
  e{ expr_eval{43} -> communication{44}(T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1})) }
  e{ communication{44} -> inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321}(T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1})) }
  e{ inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321} -> expr_eval{264}(T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1})) }
  e{ inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321} -> expr_eval{107}(T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1})) }
  e{ inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321} -> expr_eval{260}(T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1})) }
  e{ inner_outer_persistent{38, 39, 41, 42, 45, 46, 47, 49, 50, 51, 52, 53, 54, 57, 59, 60, 61, 62, 63, 65, 67, 69, 70, 71, 73, 74, 77, 79, 80, 90, 91, 94, 97, 98, 99, 100, 101, 103, 105, 106, 204, 206, 213, 214, 218, 227, 238, 239, 241, 242, 243, 244, 245, 248, 259, 261, 262, 286, 288, 289, 290, 313, 320, 321, 322, 330, 2995, 2996, 63319, 63320, 63321} -> transpose{167, 171, 174, 183, 184, 195, 198, 207, 208, 215, 220, 229, 254, 304, 311, 312, 3007, 3008}(T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})) }
  e{ expr_eval{212, 217, 225, 240} -> expr_eval{260}(T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1})) }
  e{ expr_eval{107} -> expr_eval{114, 122, 126}(T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1})) }
  e{ expr_eval{114, 122, 126} -> expr_eval{127}(T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1})) }
  e{ expr_eval{113, 120, 125} -> expr_eval{127}(T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1})) }
  e{ expr_eval{111, 118, 124} -> expr_eval{127}(T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1})) }
  e{ expr_eval{109, 116, 123} -> expr_eval{127}(T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1})) }
  e{ expr_eval{127} -> pointwise{128, 132}(T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1})) }
  e{ expr_eval{127} -> pointwise{129, 134}(T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1})) }
  e{ expr_eval{127} -> pointwise{130, 136}(T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1})) }
  e{ pointwise{130, 136} -> reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257}(T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1})) }
  e{ pointwise{129, 134} -> reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257}(T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1})) }
  e{ pointwise{128, 132} -> reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257}(T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1})) }
  e{ reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257} -> expr_eval{258}(T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1})) }
  e{ reduction{137, 139, 140, 141, 142, 144, 146, 148, 149, 150, 222, 234, 235, 237, 257} -> expr_eval{151}(T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1})) }
  e{ expr_eval{151} -> communication{152}(T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1})) }
  e{ communication{152} -> reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311}(T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1})) }
  e{ reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311} -> reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339}(T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1})) }
  e{ reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311} -> reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339}(T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1})) }
  e{ reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311} -> expr_eval{258}(T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1})) }
  e{ reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311} -> reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339}(T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})) }
  e{ reduction{153, 154, 156, 157, 158, 159, 169, 201, 203, 210, 211, 216, 223, 230, 231, 232, 233, 236, 255, 256, 298, 299, 300, 331, 2999, 3000, 63309, 63311} -> reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339}(T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1})) }
  e{ reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339} -> transpose{167, 171, 174, 183, 184, 195, 198, 207, 208, 215, 220, 229, 254, 304, 311, 312, 3007, 3008}(T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})) }
  e{ reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339} -> transpose{167, 171, 174, 183, 184, 195, 198, 207, 208, 215, 220, 229, 254, 304, 311, 312, 3007, 3008}(T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})) }
  e{ reduction{164, 165, 166, 173, 175, 177, 178, 181, 209, 339} -> transpose{167, 171, 174, 183, 184, 195, 198, 207, 208, 215, 220, 229, 254, 304, 311, 312, 3007, 3008}(T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1})) }

group details:
g{(reduction)
group id: 21
inputs:
  i0 int64_t
  i1 int64_t
  T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}) __bfloat
  T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1}) __bfloat
  T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1}) __bfloat


T21_g___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i1);
(285)
T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T21_g___bfloat[bS53{1}, iS54{2048}, iS55{12288}] (DeviceMesh{0 1}));
(3)
T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1})
   = T24_l_float[bS63{1}, iS64{2048}, iS65{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
(4)
T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   = __to_float(T25_l_bool[bS66{1}, iS67{2048}, iS68{12288}] (DeviceMesh{0 1}));
(7)
T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}));
(2)
T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T23_l_float[bS60{1}, iS61{2048}, iS62{12288}] (DeviceMesh{0 1});
(6)
T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1})
   = T28_l_float[bS76{1}, iS77{2048}, iS78{12288}] (DeviceMesh{0 1})
   * T27_l_float[bS73{1}, iS74{2048}, iS75{12288}] (DeviceMesh{0 1});
(9)
T251_g_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1})
   = squeeze( T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(250)
T252_g_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1})
   = reduction( T251_g_float[iS812{2048}, iS813{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(251)
T266_g___bfloat[iS845{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T252_g_float[rS814{2048}, iS815{12288}] (DeviceMesh{0 1}));
(265)
T32_g___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T30_g_float[bS83{1}, iS84{2048}, iS85{12288}] (DeviceMesh{0 1}));
(11)
T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1})
   = squeeze( T32_g___bfloat[bS90{1}, iS91{2048}, iS92{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(13)
T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1})
   = Set.Permute( T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
(253)
}

g{(expr_eval)
group id: 1
inputs:
  T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1}) __bfloat
  T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1}) __bfloat


T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1})
   = matmul(T34_g___bfloat[iS97{2048}, iS98{12288}] (DeviceMesh{0 1}),
            T2_g___bfloat[ideviceIdx.x7{2}, iS8{12288}, iS9{24576}] (DeviceMesh{0 1}))
(15)
}

g{(reduction)
group id: 24
inputs:
  T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1}) __bfloat
  T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}) __bfloat
  T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1}) __bfloat
  T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1}) __bfloat
  T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1}) __bfloat


T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T0_g___bfloat[ideviceIdx.x0{2}, bS1{1}, iS2{2048}, iS3{24576}] (DeviceMesh{0 1}));
(1)
T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
(63315)
T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1})
   = T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
(63314)
T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T29_l_float[ideviceIdx.x79{2}, bS80{1}, iS81{2048}, iS82{24576}] (DeviceMesh{0 1});
(10)
T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   + T31_l_float[ideviceIdx.x86{2}, bS87{1}, iS88{2048}, iS89{24576}] (DeviceMesh{0 1});
(63313)
T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T33_l_float[ideviceIdx.x93{2}, bS94{1}, iS95{2048}, iS96{24576}] (DeviceMesh{0 1});
(14)
T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   = tanhf(T35_l_float[ideviceIdx.x99{2}, bS100{1}, iS101{2048}, iS102{24576}] (DeviceMesh{0 1}));
(16)
T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1});
(20)
T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   = double(1)
   + T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
(24)
T221_g_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1})
   = T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1});
(219)
T229_g___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T221_g_float[ideviceIdx.x727{2}, bS728{1}, iS729{2048}, iS730{24576}] (DeviceMesh{0 1}));
(228)
T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1})
   = squeeze( T229_g___bfloat[ideviceIdx.x758{2}, bS759{1}, iS760{2048}, iS761{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(252)
T38_g___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1})
   = broadcast( T36_g___bfloat[ideviceIdx.x103{2}, iS104{2048}, iS105{24576}, rS106{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(17)
T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1})
   = __bfloat2float(T38_g___bfloat[ideviceIdx.x111{2}, iS113{2048}, iS114{24576}, bS112{1}] (DeviceMesh{0 1}));
(19)
T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   = T41_g_float[ideviceIdx.x123{2}, bS124{1}, iS125{2048}, iS126{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
(22)
T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1})
   = T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1})
   * T37_g_float[ideviceIdx.x107{2}, bS108{1}, iS109{2048}, iS110{24576}] (DeviceMesh{0 1});
(18)
T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1})
   = double(1)
   - T39_l_float[ideviceIdx.x115{2}, bS116{1}, iS117{2048}, iS118{24576}] (DeviceMesh{0 1});
(21)
T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1})
   = T43_l_float[ideviceIdx.x131{2}, bS132{1}, iS133{2048}, iS134{24576}] (DeviceMesh{0 1})
   * T42_l_float[ideviceIdx.x127{2}, bS128{1}, iS129{2048}, iS130{24576}] (DeviceMesh{0 1});
(23)
T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   = double(0.79788499999999996)
   * T44_l_float[ideviceIdx.x135{2}, bS136{1}, iS137{2048}, iS138{24576}] (DeviceMesh{0 1});
(25)
T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1})
   = double(0.044714999999999998)
   * T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1});
(27)
T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
(63317)
T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1})
   = T22_l_float[ideviceIdx.x56{2}, bS57{1}, iS58{2048}, iS59{24576}] (DeviceMesh{0 1})
   * T50_l_float[ideviceIdx.x159{2}, bS160{1}, iS161{2048}, iS162{24576}] (DeviceMesh{0 1});
(63316)
T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1})
   = T45_g_float[ideviceIdx.x139{2}, bS140{1}, iS141{2048}, iS142{24576}] (DeviceMesh{0 1})
   * T40_l_float[ideviceIdx.x119{2}, bS120{1}, iS121{2048}, iS122{24576}] (DeviceMesh{0 1});
(63312)
T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1})
   = double(0.5)
   * T47_l_float[ideviceIdx.x147{2}, bS148{1}, iS149{2048}, iS150{24576}] (DeviceMesh{0 1});
(28)
T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   = T46_g_float[ideviceIdx.x143{2}, bS144{1}, iS145{2048}, iS146{24576}] (DeviceMesh{0 1})
   + T49_l_float[ideviceIdx.x155{2}, bS156{1}, iS157{2048}, iS158{24576}] (DeviceMesh{0 1});
(31)
T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1})
   = T26_g_float[ideviceIdx.x69{2}, bS70{1}, iS71{2048}, iS72{24576}] (DeviceMesh{0 1})
   * T48_g_float[ideviceIdx.x151{2}, bS152{1}, iS153{2048}, iS154{24576}] (DeviceMesh{0 1});
(30)
T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   = T52_l_float[ideviceIdx.x167{2}, bS168{1}, iS169{2048}, iS170{24576}] (DeviceMesh{0 1})
   + T51_l_float[ideviceIdx.x163{2}, bS164{1}, iS165{2048}, iS166{24576}] (DeviceMesh{0 1});
(33)
T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   = T54_l_float[ideviceIdx.x175{2}, bS176{1}, iS177{2048}, iS178{24576}] (DeviceMesh{0 1})
   + T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
(34)
T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1})
   = T55_l_float[ideviceIdx.x179{2}, bS180{1}, iS181{2048}, iS182{24576}] (DeviceMesh{0 1})
   + T53_g_float[ideviceIdx.x171{2}, bS172{1}, iS173{2048}, iS174{24576}] (DeviceMesh{0 1});
(35)
T247_g_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1})
   = squeeze( T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(246)
T248_g_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1})
   = reduction( T247_g_float[ideviceIdx.x801{2}, iS802{2048}, iS803{24576}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(247)
T264_g___bfloat[ideviceIdx.x839{2}, iS840{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T248_g_float[ideviceIdx.x804{2}, rS805{2048}, iS806{24576}] (DeviceMesh{0 1}));
(263)
T58_g___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1})
   = __float2bfloat(T56_g_float[ideviceIdx.x183{2}, bS184{1}, iS185{2048}, iS186{24576}] (DeviceMesh{0 1}));
(37)
T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1})
   = squeeze( T58_g___bfloat[ideviceIdx.x190{2}, bS191{1}, iS192{2048}, iS193{24576}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(40)
T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1})
   = Set.Permute( T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}), cache_op=Streaming )
(249)
}

g{(expr_eval)
group id: 0
inputs:
  T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1}) __bfloat
  T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1}) __bfloat


T267_g___bfloat[ideviceIdx.x846{2}, iS847{12288}, iS848{24576}, rS849{2048}] (DeviceMesh{0 1})
   = matmul(T254_g___bfloat[iS819{2048}, iS820{12288}] (DeviceMesh{0 1}),
            T253_g___bfloat[ideviceIdx.x816{2}, iS817{2048}, iS818{24576}] (DeviceMesh{0 1}))
(266)
}

g{(expr_eval)
group id: 3
inputs:
  T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1}) __bfloat
  T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}) __bfloat
outputs:
  T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1}) __bfloat


T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1})
   = matmul(T61_g___bfloat[ideviceIdx.x200{2}, iS201{2048}, iS202{24576}] (DeviceMesh{0 1}),
            T4_g___bfloat[ideviceIdx.x13{2}, iS14{24576}, iS15{12288}] (DeviceMesh{0 1}))
(43)
}

g{(communication)
group id: 4
inputs:
  T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1}) __bfloat
outputs:
  T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1}) __bfloat


T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1})
   = reduction( T64_g___bfloat[ideviceIdx.x209{2}, iS210{2048}, iS211{12288}, rS212{24576}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
(44)
}

g{(inner_outer_persistent)
group id: 25
inputs:
  T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}) __bfloat
  T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1}) __bfloat
  T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1}) __bfloat
  T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}) float
  T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}) __bfloat
  T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1}) float
  T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1}) __bfloat
  i22 int64_t
  i23 int64_t
  T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1}) float
  T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}) __bfloat
  T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1}) __bfloat
  T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1}) __bfloat
  T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1}) __bfloat
  T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1}) __bfloat
  T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1}) __bfloat


T63_g_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T3_g___bfloat[bS10{1}, iS11{2048}, iS12{12288}] (DeviceMesh{0 1}));
(42)
T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1})
   = broadcast( T20_g___bfloat[iS52{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
(204)
T208_g___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}) = expand( T207_l___bfloat[iS683{12288}, bS681{1}, bS682{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(290)
T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1})
   = broadcast( T5_g___bfloat[iS16{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
(47)
T69_g___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}) = expand( T68_l___bfloat[iS224{12288}, bS222{1}, bS223{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(289)
T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T69_g___bfloat[iS227{12288}, bS225{1}, bS226{1 ex 2048}] (DeviceMesh{0 1}));
(54)
T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T208_g___bfloat[iS686{12288}, bS684{1}, bS685{1 ex 2048}] (DeviceMesh{0 1}));
(213)
T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
(49)
T71_g_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1})
   = Set( T70_l_float[bS228{1}, iS229{2048}, bS230{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(50)
T77_g_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1}) = expand( T71_g_float[bS231{1}, iS232{2048}, bS233{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(322)
T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1})
   = Set( T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(65)
T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1}) = expand( T86_l_float[bS274{1}, iS275{2048}, bS276{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(288)
T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
(52)
T57_g___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1})
   = rng_uniform({1, 2048, 12288}, __bfloat, i23);
(286)
T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T57_g___bfloat[bS187{1}, iS188{2048}, iS189{12288}] (DeviceMesh{0 1}));
(38)
T60_g_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1})
   = T59_l_float[bS194{1}, iS195{2048}, iS196{12288}] (DeviceMesh{0 1})
   < double(0.90000000000000002);
(39)
T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   = __to_float(T60_g_bool[bS197{1}, iS198{2048}, iS199{12288}] (DeviceMesh{0 1}));
(41)
T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   = T63_g_float[bS206{1}, iS207{2048}, iS208{12288}] (DeviceMesh{0 1})
   * T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1});
(45)
T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1})
   = T66_l_float[bS216{1}, iS217{2048}, iS218{12288}] (DeviceMesh{0 1})
   * double(1.11111);
(51)
T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   = T73_l_float[bS237{1}, iS238{2048}, iS239{12288}] (DeviceMesh{0 1})
   + T72_l_float[bS234{1}, iS235{2048}, iS236{12288}] (DeviceMesh{0 1});
(57)
T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   = T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T77_g_float[bS249{1}, iS250{2048}, bS251{1 ex 12288}] (DeviceMesh{0 1});
(59)
T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   = T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1});
(206)
T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   = T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1});
(214)
T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1})
   = T216_l_float[bS710{1}, iS711{2048}, iS712{12288}] (DeviceMesh{0 1})
   + T215_l_float[bS707{1}, bS708{1 ex 2048}, iS709{12288}] (DeviceMesh{0 1});
(218)
T228_g___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T220_l_float[bS724{1}, iS725{2048}, iS726{12288}] (DeviceMesh{0 1}));
(227)
T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1})
   = squeeze( T228_g___bfloat[bS755{1}, iS756{2048}, iS757{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(248)
T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1})
   = broadcast( T6_g_float[bS17{1}, iS18{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
(79)
T101_g_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1})
   = Set( T100_l_float[bS310{1}, iS311{2048}, bS312{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(80)
T106_g_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1}) = expand( T101_g_float[bS313{1}, iS314{2048}, bS315{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(313)
T111_g_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1})
   = T78_g_float[bS252{1}, iS253{2048}, iS254{12288}] (DeviceMesh{0 1})
   - T106_g_float[bS326{1}, iS327{2048}, bS328{1 ex 12288}] (DeviceMesh{0 1});
(90)
T88_g_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1})
   = pow(T8_g_float[bS22{1}, iS23{2048}, bS24{1}] (DeviceMesh{0 1})
  , double(3));
(67)
T285_g_float[bS907{1}, iS908{2048}, iS909{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T1_g___bfloat[bS4{1}, iS5{2048}, iS6{12288}] (DeviceMesh{0 1}));
(2995)
T67_g___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1})
   = broadcast( T65_g___bfloat[rdeviceIdx.x213{2}, iS214{2048}, iS215{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(46)
T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T67_g___bfloat[iS220{2048}, iS221{12288}, bS219{1}] (DeviceMesh{0 1}));
(53)
T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1})
   = T209_g_float[bS687{1}, iS688{2048}, iS689{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
(63320)
T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1})
   = squeeze( T227_l_float[bS752{1}, iS753{2048}, iS754{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(242)
T244_g_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1})
   = reduction( T243_l_float[iS793{2048}, iS794{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(243)
T262_g___bfloat[iS837{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T244_g_float[rS795{2048}, iS796{12288}] (DeviceMesh{0 1}));
(261)
T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1})
   = squeeze( T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(244)
T246_g_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1})
   = reduction( T245_l_float[iS797{2048}, iS798{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(245)
T263_g___bfloat[iS838{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T246_g_float[rS799{2048}, iS800{12288}] (DeviceMesh{0 1}));
(262)
T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1})
   = T75_l_float[bS243{1}, bS244{1 ex 2048}, iS245{12288}] (DeviceMesh{0 1})
   * T74_l_float[bS240{1}, iS241{2048}, iS242{12288}] (DeviceMesh{0 1});
(63321)
T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1})
   = T80_g_float[bS258{1}, iS259{2048}, iS260{12288}] (DeviceMesh{0 1})
   * T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
(60)
T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1})
   = squeeze( T81_l_float[bS261{1}, iS262{2048}, iS263{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(61)
T83_g_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1})
   = reduction( T82_l_float[iS264{2048}, iS265{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(62)
T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   = T87_g_float[bS277{1}, iS278{2048}, bS279{1 ex 12288}] (DeviceMesh{0 1})
   * T79_g_float[bS255{1}, iS256{2048}, iS257{12288}] (DeviceMesh{0 1});
(69)
T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1})
   = -T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1});
(71)
T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1})
   = squeeze( T92_l_float[bS292{1}, iS293{2048}, iS294{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(73)
T95_g_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1})
   = reduction( T94_l_float[iS296{2048}, iS297{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(74)
T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1})
   = broadcast( T95_g_float[iS298{2048}, rS299{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
(77)
T117_g_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1}) = expand( T98_l_float[iS305{2048}, bS304{1}, bS306{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(330)
T119_g_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T117_g_float[iS358{2048}, bS357{1}, bS359{1 ex 12288}] (DeviceMesh{0 1});
(99)
T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1})
   = broadcast( T83_g_float[iS266{2048}, rS267{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
(63)
T89_g_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T84_l_float[iS269{2048}, bS268{1}, bS270{1}] (DeviceMesh{0 1});
(321)
T91_g_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1})
   = T89_g_float[bS283{1}, iS284{2048}, bS285{1}] (DeviceMesh{0 1})
   * T88_g_float[bS280{1}, iS281{2048}, bS282{1}] (DeviceMesh{0 1});
(70)
T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1}) = expand( T91_g_float[bS289{1}, iS290{2048}, bS291{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(320)
T112_g_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T108_l_float[bS332{1}, iS333{2048}, bS334{1 ex 12288}] (DeviceMesh{0 1});
(91)
T115_g_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   = T112_g_float[bS342{1}, iS343{2048}, bS344{1 ex 12288}] (DeviceMesh{0 1})
   * T111_g_float[bS339{1}, iS340{2048}, iS341{12288}] (DeviceMesh{0 1});
(94)
d586 = reciprocal(double(12288));
(97)
T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1})
   = T115_g_float[bS351{1}, iS352{2048}, iS353{12288}] (DeviceMesh{0 1})
   * d586;
(98)
T120_g_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1})
   = T119_g_float[bS363{1}, iS364{2048}, bS365{1 ex 12288}] (DeviceMesh{0 1})
   + T118_l_float[bS360{1}, iS361{2048}, iS362{12288}] (DeviceMesh{0 1});
(100)
T121_g_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1})
   = T90_g_float[bS286{1}, iS287{2048}, iS288{12288}] (DeviceMesh{0 1})
   + T120_g_float[bS366{1}, iS367{2048}, iS368{12288}] (DeviceMesh{0 1});
(101)
T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   = T285_g_float[bS907{1}, iS908{2048}, iS909{12288}] (DeviceMesh{0 1})
   + T121_g_float[bS369{1}, iS370{2048}, iS371{12288}] (DeviceMesh{0 1});
(2996)
T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1})
   = double(1.11111)
   * T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1});
(103)
T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1})
   = T62_l_float[bS203{1}, iS204{2048}, iS205{12288}] (DeviceMesh{0 1})
   * T123_l_float[bS375{1}, iS376{2048}, iS377{12288}] (DeviceMesh{0 1});
(63319)
T239_g_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1})
   = squeeze( T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(238)
T240_g_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1})
   = reduction( T239_g_float[iS784{2048}, iS785{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(239)
T260_g___bfloat[iS832{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T240_g_float[rS786{2048}, iS787{12288}] (DeviceMesh{0 1}));
(259)
T125_g___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T124_g_float[bS378{1}, iS379{2048}, iS380{12288}] (DeviceMesh{0 1}));
(105)
T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1})
   = squeeze( T125_g___bfloat[bS381{1}, iS382{2048}, iS383{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(106)
T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1})
   = Set.Permute( T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}), cache_op=Streaming )
(241)
}

g{(expr_eval)
group id: 2
inputs:
  T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1}) __bfloat
  T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1}) __bfloat
outputs:
  T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1}) __bfloat


T265_g___bfloat[ideviceIdx.x841{2}, iS842{24576}, iS843{12288}, rS844{2048}] (DeviceMesh{0 1})
   = matmul(T250_g___bfloat[ideviceIdx.x809{2}, iS810{2048}, iS811{24576}] (DeviceMesh{0 1}),
            T249_g___bfloat[iS807{2048}, iS808{12288}] (DeviceMesh{0 1}))
(264)
}

g{(expr_eval)
group id: 18
inputs:
  T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}) __bfloat
outputs:
  T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1}) __bfloat


T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1})
   = Set.Permute( T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}), cache_op=Streaming )
(212)
T219_g___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1})
   = Set( T214_l___bfloat[ideviceIdx.x702{2}, bS703{1}, iS705{2048}, iS704{48}, iS706{128}] (DeviceMesh{0 1}), cache_op=Streaming )
(217)
T226_g___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}) = view( T219_g___bfloat[ideviceIdx.x719{2}, bS720{1}, iS721{2048}, iS722{48}, iS723{128}] (DeviceMesh{0 1}) )
(225)
T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1})
   = squeeze( T226_g___bfloat[ideviceIdx.x744{2}, bS745{1}, iS746{2048}, iS751{6144}rf] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(240)
}

g{(expr_eval)
group id: 5
inputs:
  T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1}) __bfloat
  T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1}) __bfloat


T261_g___bfloat[ideviceIdx.x833{2}, iS834{12288}, iS835{6144}, rS836{2048}] (DeviceMesh{0 1})
   = matmul(T242_g___bfloat[iS791{2048}, iS792{12288}] (DeviceMesh{0 1}),
            T241_g___bfloat[ideviceIdx.x788{2}, iS789{2048}, iS790{6144}] (DeviceMesh{0 1}))
(260)
}

g{(expr_eval)
group id: 6
inputs:
  T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1}) __bfloat
  T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1}) __bfloat


T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1})
   = matmul(T126_g___bfloat[iS384{2048}, iS385{12288}] (DeviceMesh{0 1}),
            T9_g___bfloat[ideviceIdx.x25{2}, iS26{12288}, iS27{6144}] (DeviceMesh{0 1}))
(107)
}

g{(expr_eval)
group id: 14
inputs:
  T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1}) __bfloat


T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1})
   = broadcast( T127_g___bfloat[ideviceIdx.x386{2}, iS387{2048}, iS388{6144}, rS389{12288}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(114)
T135_g___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}) = view( T131_l___bfloat[ideviceIdx.x405{2}, iS407{2048}, iS408{6144}, bS406{1}] (DeviceMesh{0 1}) )
(122)
T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1})
   = Set.Permute( T135_g___bfloat[ideviceIdx.x430{2}, iS432{2048}, iS435{48}rf, iS436{128}rf, bS431{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(126)
}

g{(expr_eval)
group id: 15
inputs:
  T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1}) __bfloat


T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {0, 6144, 1} } )
(113)
T134_g___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}) = view( T130_l___bfloat[ideviceIdx.x400{2}, bS401{1}, iS402{2048}, iS404{6144}rf] (DeviceMesh{0 1}) )
(120)
T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1})
   = Set.Permute( T134_g___bfloat[ideviceIdx.x423{2}, bS424{1}, iS425{2048}, iS428{48}rf, iS429{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
(125)
}

g{(expr_eval)
group id: 16
inputs:
  T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1}) __bfloat


T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {6144, 12288, 1} } )
(111)
T133_g___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}) = view( T129_l___bfloat[ideviceIdx.x395{2}, bS396{1}, iS397{2048}, iS399{6144}rf] (DeviceMesh{0 1}) )
(118)
T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1})
   = Set.Permute( T133_g___bfloat[ideviceIdx.x416{2}, bS417{1}, iS418{2048}, iS421{48}rf, iS422{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
(124)
}

g{(expr_eval)
group id: 17
inputs:
  T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1}) __bfloat


T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1})
   = slice( T10_g___bfloat[ideviceIdx.x28{2}, bS29{1}, iS30{2048}, iS31{18432}] (DeviceMesh{0 1}), { {0, 2, 1} {0, 1, 1} {0, 2048, 1} {12288, 18432, 1} } )
(109)
T132_g___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}) = view( T128_l___bfloat[ideviceIdx.x390{2}, bS391{1}, iS392{2048}, iS394{6144}rf] (DeviceMesh{0 1}) )
(116)
T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1})
   = Set.Permute( T132_g___bfloat[ideviceIdx.x409{2}, bS410{1}, iS411{2048}, iS414{48}rf, iS415{128}rf] (DeviceMesh{0 1}), cache_op=Streaming )
(123)
}

g{(expr_eval)
group id: 7
inputs:
  T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}) __bfloat
  T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1}) float
  T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1}) uint64_t
  T14_g_uint64_t[] (DeviceMesh{0 1}) uint64_t
  T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1}) __bfloat
  T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1}) __bfloat
  T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1}) __bfloat
  T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1}) __bfloat
outputs:
  T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}) __bfloat
  T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}) __bfloat
  T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1}) __bfloat


T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}),
T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}),
T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1})
   = sdpa_bwd(T139_g___bfloat[ideviceIdx.x452{2}, iS454{2048}, iS455{48}, iS456{128}, bS453{1}] (DeviceMesh{0 1}),
            T138_g___bfloat[ideviceIdx.x447{2}, bS448{1}, iS449{2048}, iS450{48}, iS451{128}] (DeviceMesh{0 1}),
            T137_g___bfloat[ideviceIdx.x442{2}, bS443{1}, iS444{2048}, iS445{48}, iS446{128}] (DeviceMesh{0 1}),
            T136_g___bfloat[ideviceIdx.x437{2}, bS438{1}, iS439{2048}, iS440{48}, iS441{128}] (DeviceMesh{0 1}),
            T11_g___bfloat[ideviceIdx.x32{2}, bS33{1}, iS35{2048}, iS34{48}, iS36{128}] (DeviceMesh{0 1}),
            logsum_exp = T12_g_float[ideviceIdx.x37{2}, bS38{1}, iS39{48}, iS40{2048}] (DeviceMesh{0 1}),
            dropout_p = double(0.10000000000000001),
            is_causal = true,
            philox_seed = T13_g_uint64_t[iS41{2}] (DeviceMesh{0 1}),
            philox_offset = T14_g_uint64_t[] (DeviceMesh{0 1}),
  )
(127)
}

g{(pointwise)
group id: 11
inputs:
  T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}) __bfloat
outputs:
  T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}) __bfloat


T145_g___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1})
   = Set.Permute( T140_g___bfloat[ideviceIdx.x457{2}, bS458{1}, iS460{2048}, iS459{48}, iS461{128}] (DeviceMesh{0 1}), cache_op=Streaming )
(130)
T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}) = view( T145_g___bfloat[ideviceIdx.x482{2}, bS483{1}, iS484{48}, iS485{2048}, iS486{128}] (DeviceMesh{0 1}) )
(136)
}

g{(pointwise)
group id: 12
inputs:
  T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}) __bfloat
outputs:
  T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}) __bfloat


T144_g___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1})
   = Set.Permute( T141_g___bfloat[ideviceIdx.x462{2}, bS463{1}, iS465{2048}, iS464{48}, iS466{128}] (DeviceMesh{0 1}), cache_op=Streaming )
(129)
T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}) = view( T144_g___bfloat[ideviceIdx.x477{2}, bS478{1}, iS479{48}, iS480{2048}, iS481{128}] (DeviceMesh{0 1}) )
(134)
}

g{(pointwise)
group id: 13
inputs:
  T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1}) __bfloat
outputs:
  T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}) __bfloat


T143_g___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1})
   = Set.Permute( T142_g___bfloat[ideviceIdx.x467{2}, bS468{1}, iS470{2048}, iS469{48}, iS471{128}] (DeviceMesh{0 1}), cache_op=Streaming )
(128)
T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}) = view( T143_g___bfloat[ideviceIdx.x472{2}, bS473{1}, iS474{48}, iS475{2048}, iS476{128}] (DeviceMesh{0 1}) )
(132)
}

g{(reduction)
group id: 20
inputs:
  T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}) __bfloat
  T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}) __bfloat
  T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}) __bfloat
outputs:
  T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}) __bfloat
  T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1}) __bfloat
  T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1}) __bfloat


T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1})
   = pad( T148_g___bfloat[ideviceIdx.x503{2}, bS504{1}, iS505{2048}, iS510{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, 0, 12288} )
(139)
i834 = 0 + 6144;
(137)
T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T147_g___bfloat[ideviceIdx.x495{2}, bS496{1}, iS497{2048}, iS502{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i834, 6144} )
(144)
i849 = i834 + 6144;
(140)
T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1})
   = pad( T146_g___bfloat[ideviceIdx.x487{2}, bS488{1}, iS489{2048}, iS494{6144}rf] (DeviceMesh{0 1}), {0, 0, 0, 0, 0, 0, i849, 0} )
(148)
T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1})
   = cat( T149_l___bfloat[ideviceIdx.x511{2}, bS512{1}, iS513{2048}, iS515{18432}rf] (DeviceMesh{0 1}), T150_l___bfloat[ideviceIdx.x516{2}, bS517{1}, iS518{2048}, iS520{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), T151_l___bfloat[ideviceIdx.x521{2}, bS522{1}, iS523{2048}, iS525{( ( ( 0 + 6144 ) + 6144 ) + 6144 )}rf] (DeviceMesh{0 1}), 3 )
(149)
T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1})
   = squeeze( T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(150)
T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1})
   = Set.Permute( T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}), cache_op=Streaming )
(237)
T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1})
   = __bfloat2float(T152_g___bfloat[ideviceIdx.x526{2}, bS527{1}, iS528{2048}, iS529{18432}] (DeviceMesh{0 1}));
(222)
T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1})
   = squeeze( T224_l_float[ideviceIdx.x737{2}, bS738{1}, iS739{2048}, iS740{18432}] (DeviceMesh{0 1}), flags = {false, true, false, false} )
(234)
T236_g_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1})
   = reduction( T235_l_float[ideviceIdx.x773{2}, iS774{2048}, iS775{18432}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(235)
T258_g___bfloat[ideviceIdx.x826{2}, iS827{18432}] (DeviceMesh{0 1})
   = __float2bfloat(T236_g_float[ideviceIdx.x776{2}, rS777{2048}, iS778{18432}] (DeviceMesh{0 1}));
(257)
i876 = i849 + 6144;
(146)
i860 = i834 + 6144;
(141)
i863 = i860 + 6144;
(142)
}

g{(expr_eval)
group id: 9
inputs:
  T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1}) __bfloat
  T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1}) __bfloat


T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1})
   = matmul(T153_g___bfloat[ideviceIdx.x530{2}, iS531{2048}, iS532{18432}] (DeviceMesh{0 1}),
            T15_g___bfloat[ideviceIdx.x42{2}, iS43{18432}, iS44{12288}] (DeviceMesh{0 1}))
(151)
}

g{(communication)
group id: 10
inputs:
  T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1}) __bfloat


T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1})
   = reduction( T154_g___bfloat[ideviceIdx.x533{2}, iS534{2048}, iS535{12288}, rS536{18432}] (DeviceMesh{0 1}), op = add, initial value = __bfloat(0), allreduce = false )
(152)
}

g{(reduction)
group id: 23
inputs:
  T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}) __bfloat
  T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1}) __bfloat
  T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}) float
  T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}) float
  T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1}) __bfloat
  T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1}) __bfloat
outputs:
  T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1}) float
  T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1}) float
  T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1}) float
  T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1}) __bfloat
  T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1}) __bfloat
  T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1}) __bfloat


T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1})
   = Set( T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(169)
T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1}) = expand( T172_l_float[bS586{1}, iS587{2048}, bS588{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(298)
T287_l_float[bS913{1}, iS914{2048}, iS915{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
(2999)
T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
(156)
T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1})
   = Set( T159_l_float[bS549{1}, iS550{2048}, bS551{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(157)
T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1}) = expand( T160_l_float[bS552{1}, iS553{2048}, bS554{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(331)
T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   = T287_l_float[bS913{1}, iS914{2048}, iS915{12288}] (DeviceMesh{0 1})
   - T164_l_float[bS564{1}, iS565{2048}, bS566{1 ex 12288}] (DeviceMesh{0 1});
(3000)
T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   = T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1});
(203)
T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1})
   = broadcast( T19_g___bfloat[iS51{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
(201)
T205_g___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}) = expand( T204_l___bfloat[iS674{12288}, bS672{1}, bS673{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(300)
T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1})
   = broadcast( T16_g___bfloat[iS45{12288}] (DeviceMesh{0 1}), flags = {true, true, false} )
(154)
T158_g___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}) = expand( T157_l___bfloat[iS545{12288}, bS543{1}, bS544{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(299)
T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T158_g___bfloat[iS548{12288}, bS546{1}, bS547{1 ex 2048}] (DeviceMesh{0 1}));
(159)
T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   = T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1});
(211)
T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T205_g___bfloat[iS677{12288}, bS675{1}, bS676{1 ex 2048}] (DeviceMesh{0 1}));
(210)
T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1})
   = T213_l_float[bS699{1}, iS700{2048}, iS701{12288}] (DeviceMesh{0 1})
   + T212_l_float[bS696{1}, bS697{1 ex 2048}, iS698{12288}] (DeviceMesh{0 1});
(216)
T225_g___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T218_l_float[bS716{1}, iS717{2048}, iS718{12288}] (DeviceMesh{0 1}));
(223)
T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1})
   = squeeze( T225_g___bfloat[bS741{1}, iS742{2048}, iS743{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(236)
T156_g___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1})
   = broadcast( T155_g___bfloat[rdeviceIdx.x537{2}, iS538{2048}, iS539{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(153)
T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T156_g___bfloat[iS541{2048}, iS542{12288}, bS540{1}] (DeviceMesh{0 1}));
(158)
T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1})
   = T206_g_float[bS678{1}, iS679{2048}, iS680{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
(63309)
T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1})
   = squeeze( T223_l_float[bS734{1}, iS735{2048}, iS736{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(230)
T232_g_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1})
   = reduction( T231_l_float[iS765{2048}, iS766{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(231)
T256_g___bfloat[iS824{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T232_g_float[rS767{2048}, iS768{12288}] (DeviceMesh{0 1}));
(255)
T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1})
   = squeeze( T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(232)
T234_g_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1})
   = reduction( T233_l_float[iS769{2048}, iS770{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(233)
T257_g___bfloat[iS825{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T234_g_float[rS771{2048}, iS772{12288}] (DeviceMesh{0 1}));
(256)
T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1})
   = T162_l_float[bS558{1}, bS559{1 ex 2048}, iS560{12288}] (DeviceMesh{0 1})
   * T161_l_float[bS555{1}, iS556{2048}, iS557{12288}] (DeviceMesh{0 1});
(63311)
}

g{(expr_eval)
group id: 8
inputs:
  T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1}) __bfloat
  T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1}) __bfloat
outputs:
  T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1}) __bfloat


T259_g___bfloat[ideviceIdx.x828{2}, iS829{18432}, iS830{12288}, rS831{2048}] (DeviceMesh{0 1})
   = matmul(T238_g___bfloat[ideviceIdx.x781{2}, iS782{2048}, iS783{18432}] (DeviceMesh{0 1}),
            T237_g___bfloat[iS779{2048}, iS780{12288}] (DeviceMesh{0 1}))
(258)
}

g{(reduction)
group id: 19
inputs:
  T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1}) float
  T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1}) float
  T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1}) float
outputs:
  T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1}) float
  T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1}) float
  T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1}) float


T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1})
   = T166_g_float[bS570{1}, iS571{2048}, iS572{12288}] (DeviceMesh{0 1})
   * T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
(164)
T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1})
   = squeeze( T167_l_float[bS573{1}, iS574{2048}, iS575{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(165)
T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1})
   = reduction( T168_l_float[iS576{2048}, iS577{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(166)
T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   = T173_g_float[bS589{1}, iS590{2048}, bS591{1 ex 12288}] (DeviceMesh{0 1})
   * T165_g_float[bS567{1}, iS568{2048}, iS569{12288}] (DeviceMesh{0 1});
(173)
T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1})
   = -T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1});
(175)
T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1})
   = squeeze( T178_l_float[bS604{1}, iS605{2048}, iS606{12288}] (DeviceMesh{0 1}), flags = {true, false, false} )
(177)
T181_g_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1})
   = reduction( T180_l_float[iS608{2048}, iS609{12288}] (DeviceMesh{0 1}), op = add, initial value = float(0), allreduce = false )
(178)
T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1})
   = broadcast( T181_g_float[iS610{2048}, rS611{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
(181)
T203_g_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1}) = expand( T184_l_float[iS617{2048}, bS616{1}, bS618{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(339)
T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   = double(8.1380208333333329e-05)
   * T203_g_float[iS670{2048}, bS669{1}, bS671{1 ex 12288}] (DeviceMesh{0 1});
(209)
}

g{(transpose)
group id: 22
inputs:
  T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}) __bfloat
  T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}) float
  T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}) float
  T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1}) float
  T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1}) float
  T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1}) float
  T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1}) float
outputs:
  T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1}) __bfloat


T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1})
   = broadcast( T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), flags = {false, false, true} )
(183)
T187_g_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1})
   = Set( T186_l_float[bS622{1}, iS623{2048}, bS624{1}] (DeviceMesh{0 1}), cache_op=Streaming )
(184)
T192_g_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1}) = expand( T187_g_float[bS625{1}, iS626{2048}, bS627{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(304)
T291_l_float[bS925{1}, iS926{2048}, iS927{12288}] (DeviceMesh{0 1})
   = __bfloat2float(T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}));
(3007)
T197_g_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1})
   = T291_l_float[bS925{1}, iS926{2048}, iS927{12288}] (DeviceMesh{0 1})
   - T192_g_float[bS638{1}, iS639{2048}, bS640{1 ex 12288}] (DeviceMesh{0 1});
(3008)
T174_g_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1})
   = pow(T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
  , double(3));
(171)
T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1})
   = broadcast( T169_g_float[iS578{2048}, rS579{12288}] (DeviceMesh{0 1}), flags = {true, false, true} )
(167)
T175_g_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   = double(-0.5)
   * T170_l_float[iS581{2048}, bS580{1}, bS582{1}] (DeviceMesh{0 1});
(312)
T177_g_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1})
   = T175_g_float[bS595{1}, iS596{2048}, bS597{1}] (DeviceMesh{0 1})
   * T174_g_float[bS592{1}, iS593{2048}, bS594{1}] (DeviceMesh{0 1});
(174)
T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1}) = expand( T177_g_float[bS601{1}, iS602{2048}, bS603{1}] (DeviceMesh{0 1}), {1, 2048, 12288} )
(311)
T198_g_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   = double(2)
   * T194_l_float[bS644{1}, iS645{2048}, bS646{1 ex 12288}] (DeviceMesh{0 1});
(195)
T201_g_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   = T198_g_float[bS654{1}, iS655{2048}, bS656{1 ex 12288}] (DeviceMesh{0 1})
   * T197_g_float[bS651{1}, iS652{2048}, iS653{12288}] (DeviceMesh{0 1});
(198)
d1089 = reciprocal(double(12288));
(207)
T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1})
   = T201_g_float[bS663{1}, iS664{2048}, iS665{12288}] (DeviceMesh{0 1})
   * d1089;
(208)
T217_g_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1})
   = T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
   + T210_l_float[bS690{1}, iS691{2048}, iS692{12288}] (DeviceMesh{0 1});
(215)
T222_g_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1})
   = T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1})
   + T217_g_float[bS713{1}, iS714{2048}, iS715{12288}] (DeviceMesh{0 1});
(220)
T230_g_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1})
   = T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
   + T222_g_float[bS731{1}, iS732{2048}, iS733{12288}] (DeviceMesh{0 1});
(229)
T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})
   = __float2bfloat(T230_g_float[bS762{1}, iS763{2048}, iS764{12288}] (DeviceMesh{0 1}));
(254)
}

} //Segmented_Fusion


===== Outer Reduction Stats ========
total_reduction_numel: 2048
total_iteration_numel: 12288
vectorize_factor: 8
redu_unroll_factor: 8
grid(96, 4, 1)
block(16, 32, 1)


===== Reduction Parameters ========

Red On Slow Dim
Circular buffer: not used

Iteration Domain: blockIdx.x / threadIdx.x / multiple reductions per block / vectorize / factor 8
Inner Reduction Domain: cross block - threadIdx.y / cross grid - blockIdx.y / split grid dim / split grid dimension / unroll / factor 8
Launch Parameters: BlockDim.x = 16, BlockDim.y = 32, BlockDim.z = -1, GridDim.x = -1, GridDim.y = 4, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = NotSet, maxrregcount = 128, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Outer Reduction Stats ========
total_reduction_numel: 2048
total_iteration_numel: 49152
vectorize_factor: 8
redu_unroll_factor: 2
grid(96, 11, 1)
block(64, 8, 1)


===== Reduction Parameters ========

Red On Slow Dim
Circular buffer: not used

Iteration Domain: blockIdx.x / threadIdx.x / multiple reductions per block / vectorize / factor 8
Inner Reduction Domain: cross block - threadIdx.y / cross grid - blockIdx.y / split grid dim / split grid dimension / unroll / factor 2
Launch Parameters: BlockDim.x = 64, BlockDim.y = 8, BlockDim.z = -1, GridDim.x = -1, GridDim.y = 11, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = NotSet, maxrregcount = 128, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Combined InnerOuter Reduction Stats ========
outer_dim_numel: 2048
inner_dim_numel: 12288
regs_buffer_size_bit: 1671168
smem_buffer_size_bit: 430080
smem_overhead_bit: 16384
vectorize_factor_input: 4
vectorization_factor_tmp_gmem_write: 4
vectorization_factor_outer: 4
multiple_reds_per_blk: 0
warps_per_sm: 8
gdimy: 142
block(32, 8, 1)
===== Reduction Parameters ========
Tag: InnerOuter Register and Shared Memory Persistent Heuristic.

Red On Fastest Dim
Persistent Kernel
Batches per block: 12
Circular buffer: not used

Iteration Domain: blockIdx.y / split grid dimension outer / 
Inner Reduction Domain: persistent batch - 12 / vectorize / factor 4
Launch Parameters: BlockDim.x = 32, BlockDim.y = 8, BlockDim.z = -1, GridDim.x = -1, GridDim.y = 142, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = int, maxrregcount = 255, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Pointwise Stats ========
num_elems: 12582912
elem_counts: 1 2048 6144
max_dtype_size_bit_for_vectorization: 16
unroll_factor_inner: 1
unroll_factor_outer: 1
vectorize_factor: 8

reorder_map: 
broadcast_byte_multiples: (0, 32), (0, 32), (32, 0), 
LHS elems: 2048 RHS elems: 6144


===== Pointwise Parameters ========
Tag: Pointwise heuristics Pointwise Characteristics:
 Gridx: 1 BlckY: 1 BlckX: 128
2D Schedule
  Bcast break point: 2
vectorization_factor: 8
unroll_factor_outer: 1
unroll_factor_inner: 1
====================================


===== Pointwise Stats ========
num_elems: 12582912
elem_counts: 1 2048 6144
max_dtype_size_bit_for_vectorization: 16
unroll_factor_inner: 1
unroll_factor_outer: 1
vectorize_factor: 8

reorder_map: 
broadcast_byte_multiples: (0, 32), (0, 32), (32, 0), 
LHS elems: 2048 RHS elems: 6144


===== Pointwise Parameters ========
Tag: Pointwise heuristics Pointwise Characteristics:
 Gridx: 1 BlckY: 1 BlckX: 128
2D Schedule
  Bcast break point: 2
vectorization_factor: 8
unroll_factor_outer: 1
unroll_factor_inner: 1
====================================


===== Pointwise Stats ========
num_elems: 12582912
elem_counts: 1 2048 6144
max_dtype_size_bit_for_vectorization: 16
unroll_factor_inner: 1
unroll_factor_outer: 1
vectorize_factor: 8

reorder_map: 
broadcast_byte_multiples: (0, 32), (0, 32), (32, 0), 
LHS elems: 2048 RHS elems: 6144


===== Pointwise Parameters ========
Tag: Pointwise heuristics Pointwise Characteristics:
 Gridx: 1 BlckY: 1 BlckX: 128
2D Schedule
  Bcast break point: 2
vectorization_factor: 8
unroll_factor_outer: 1
unroll_factor_inner: 1
====================================


===== Outer Reduction Stats ========
total_reduction_numel: 2048
total_iteration_numel: 36864
vectorize_factor: 8
redu_unroll_factor: 4
grid(72, 15, 1)
block(64, 8, 1)


===== Reduction Parameters ========

Red On Slow Dim
Circular buffer: not used

Iteration Domain: blockIdx.x / threadIdx.x / multiple reductions per block / vectorize / factor 8
Inner Reduction Domain: cross block - threadIdx.y / cross grid - blockIdx.y / split grid dim / split grid dimension / unroll / factor 4
Launch Parameters: BlockDim.x = 64, BlockDim.y = 8, BlockDim.z = -1, GridDim.x = -1, GridDim.y = 15, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = NotSet, maxrregcount = 128, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Outer Reduction Stats ========
total_reduction_numel: 2048
total_iteration_numel: 12288
vectorize_factor: 4
redu_unroll_factor: 2
grid(96, 5, 1)
block(32, 16, 1)


===== Reduction Parameters ========

Red On Slow Dim
Circular buffer: not used

Iteration Domain: blockIdx.x / threadIdx.x / multiple reductions per block / vectorize / factor 4
Inner Reduction Domain: cross block - threadIdx.y / cross grid - blockIdx.y / split grid dim / split grid dimension / unroll / factor 2
Launch Parameters: BlockDim.x = 32, BlockDim.y = 16, BlockDim.z = -1, GridDim.x = -1, GridDim.y = 5, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = NotSet, maxrregcount = 128, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Inner 2D Reduction Stats ========
total_reduction_numel: 12288
total_iteration_numel: 2048
target_vect_unroll: 2
vectorize_factor: 2
inner_unroll: 1
outer_unroll: 1
inner iteration: 24
n_tensor_inputs: 2
max_dtype_size_bit_for_vectorization: 32
block(256, 1, 1)

===== Reduction Parameters ========

Red On Fastest Dim
Circular buffer: not used

Iteration Domain: blockIdx.x / 
Inner Reduction Domain: cross block - threadIdx.x /  pad to warp / vectorize / factor 2
Launch Parameters: BlockDim.x = 256, BlockDim.y = -1, BlockDim.z = -1, GridDim.x = -1, GridDim.y = -1, GridDim.z = -1, Smem Size = 0
Compile Parameters: index_type = NotSet, maxrregcount = 255, enable_magic_zero = 1, enable_ptxas_verbose = 0, include_paths = 

====================================


===== Transpose Stats ========
inputs: T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}), T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}), T169_g_float[iS936{2048}] (DeviceMesh{0 1}), T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1}), T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1}), T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
outputs: T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})
shape: 1 2048 12288
num_elems: 25165824
n_io_tensors: 8
max_io_dtype_size: 4
group 1: T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1}), T7_g___bfloat[bS19{1}, iS20{2048}, iS21{12288}] (DeviceMesh{0 1}), T176_g_float[bS598{1}, iS599{2048}, iS600{12288}] (DeviceMesh{0 1}), T122_g_float[bS372{1}, iS373{2048}, iS374{12288}] (DeviceMesh{0 1})
reference1: T255_g___bfloat[bS821{1}, iS822{2048}, iS823{12288}] (DeviceMesh{0 1})
inner_most_id1 position: 2 (in reference 1)
group 2: T17_g_float[bS46{1}, iS47{2048}] (DeviceMesh{0 1}), T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1}), T169_g_float[iS936{2048}] (DeviceMesh{0 1}), T211_g_float[bS693{1}, iS694{2048}, bS695{1 ex 12288}] (DeviceMesh{0 1})
reference2: T18_g_float[bS48{1}, iS49{2048}, bS50{1}] (DeviceMesh{0 1})
inner_most_id2 position: 1 (in reference 1)


===== Transpose Parameters ========
Tag: Transpose heuristics Transpose Characteristics:
 BlckX: 128
 input tile size: 32
 output tile size: 32
 elements per tile: 1024
 elements per thread: 8
Vectorize group 1, Factor: 2
Unroll group 1, Factor: 4
Vectorize group 2, Factor: 2
Unroll group 2, Factor: 4
====================================

[32m.[0m
======================================================================================================== MPI Information ========================================================================================================
rank: 0
size: 2
MPI version: 3.1
MPI library version: Open MPI v4.1.9a1, package: Open MPI root@sharp-ci-02 Distribution, ident: 4.1.9a1, repo rev: v4.1.5-222-g92f9fca4eb, Unreleased developer copy 
MPI vendor: Open MPI 4.1.9
mpi4py rc: 
mpi4py config:


[33m--------------------------------------------------- benchmark: 1 tests ---------------------------------------------------[0m
Name (time in ms)                  Min       Max      Mean  StdDev    Median     IQR  Outliers     OPS  Rounds  Iterations
[33m--------------------------------------------------------------------------------------------------------------------------[0m
test_transformer_backward   [1m  118.3490[0m[1m  118.6519[0m[1m  118.5027[0m[1m  0.1111[0m[1m  118.5272[0m[1m  0.1306[0m       2;0[1m  8.4386[0m       5           1
[33m--------------------------------------------------------------------------------------------------------------------------[0m

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
[32m========================================================================================== [32m[1m1 passed[0m, [33m2 deselected[0m[32m in 61.10s (0:01:01)[0m[32m ===========================================================================================[0m
